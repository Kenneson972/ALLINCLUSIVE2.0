<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KhanelConcept - Plateforme Connectée | Villas de Luxe Martinique</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Découvrez nos villas de luxe en Martinique. Réservation en ligne avec galeries interactives, calendriers avancés et système de réservation professionnel.">
    <meta name="keywords" content="villa martinique, location villa luxe, martinique vacances, villa piscine, séjour martinique">
    <meta name="author" content="KhanelConcept">
    <meta property="og:title" content="KhanelConcept - Villas de Luxe Martinique">
    <meta property="og:description" content="Plateforme moderne de réservation de villas de luxe en Martinique avec interface glassmorphism">
    <meta property="og:type" content="website">
    
    <!-- CSS Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    
    <!-- Custom CSS -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Video Background avec votre vidéo Cloudinary */
        .video-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            overflow: hidden;
        }
        
        .video-background video {
            position: absolute;
            top: 50%;
            left: 50%;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            transform: translate(-50%, -50%);
            object-fit: cover;
            filter: brightness(0.7) contrast(1.1) saturate(1.2);
        }
            left: 50%;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            transform: translate(-50%, -50%);
            object-fit: cover;
        }
        
        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            z-index: -1;
        }
        
        /* Header Glassmorphism */
        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            position: sticky;
            top: 0;
            z-index: 50;
            transition: all 0.3s ease;
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }
        
        .logo i {
            color: #FFA500;
        }
        
        .nav-links {
            display: flex;
            gap: 1rem;
            list-style: none;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-size: 0.9rem;
            cursor: pointer;
        }
        
        .nav-links a:hover, .nav-links a.active {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }
        
        /* Main Content */
        .main-content {
            position: relative;
            z-index: 1;
        }
        
        .section {
            min-height: 100vh;
            padding: 2rem 1rem;
            display: none;
        }
        
        .section.active {
            display: block;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .section h1 {
            font-size: 2.5rem;
            font-weight: bold;
            color: white;
            text-align: center;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .section h2 {
            font-size: 2rem;
            font-weight: bold;
            color: white;
            margin: 2rem 0 1rem 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .section p {
            font-size: 1.1rem;
            color: white;
            text-align: center;
            margin-bottom: 2rem;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        /* Glass Cards */
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 1.5rem;
            margin: 1rem 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            height: auto;
            display: flex;
            flex-direction: column;
        }
        
        .glass-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
        }
        
        /* Villa Cards */
        .villa-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            height: 560px;
            display: flex;
            flex-direction: column;
        }
        
        .villa-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
        }
        
        .villa-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 15px 15px 0 0;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .villa-image:hover {
            transform: scale(1.05);
        }
        
        .villa-content {
            padding: 1.5rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .villa-content h3 {
            color: white;
            font-size: 1.3rem;
            margin-bottom: 1rem;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
        }
        
        .villa-content p {
            color: rgba(255, 255, 255, 0.9);
            text-align: left;
            margin-bottom: 0.5rem;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
            font-size: 0.9rem;
        }
        
        .price {
            font-size: 1.4rem;
            font-weight: bold;
            color: #FFA500;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
            margin: 1rem 0;
        }
        
        .villa-buttons {
            display: flex;
            gap: 0.5rem;
            margin-top: auto;
        }
        
        .btn-primary, .btn-secondary {
            padding: 8px 16px;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            text-align: center;
            flex: 1;
            font-size: 0.9rem;
        }
        
        .btn-primary {
            background: #FFA500;
            color: white;
        }
        
        .btn-primary:hover {
            background: #FF8C00;
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        /* Search Section */
        .search-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        /* ===== BARRE DE RECHERCHE STYLE BOOKING.COM ===== */
        
        .villa-search-form {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 12px;
            display: flex;
            align-items: stretch;
            gap: 0;
            box-shadow: 0 8px 32px rgba(30, 64, 175, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            max-width: 1200px;
            margin: 0 auto;
        }

        /* CHAMPS DE RECHERCHE HORIZONTAUX */
        .search-field {
            padding: 16px 20px;
            border: none;
            background: transparent;
            border-right: 1px solid rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-width: 200px;
            flex: 1;
        }

        .search-field:last-child {
            border-right: none;
            flex: 0 0 auto;
            min-width: auto;
        }

        .search-field:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .search-field label {
            font-size: 12px;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
            font-family: 'Inter', sans-serif;
        }

        /* CHAMP LOCALISATION AVEC AUTOCOMPLETE */
        .location-field {
            position: relative;
        }

        .location-input {
            border: none;
            background: transparent;
            color: #1f2937;
            font-size: 16px;
            font-weight: 500;
            font-family: 'Inter', sans-serif;
            outline: none;
            width: 100%;
            padding: 0;
        }

        .location-input::placeholder {
            color: #9ca3af;
            font-weight: 400;
        }

        /* DROPDOWN SUGGESTIONS LOCALISATION */
        .location-suggestions {
            position: absolute;
            top: 100%;
            left: -20px;
            right: -20px;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 16px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            max-height: 250px;
            overflow-y: auto;
            margin-top: 12px;
            border: 1px solid rgba(6, 182, 212, 0.2);
            display: none;
        }

        .suggestion-item {
            padding: 16px 24px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #374151;
            font-family: 'Inter', sans-serif;
            font-weight: 500;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .suggestion-item:hover {
            background: rgba(59, 130, 246, 0.08);
            color: #1d4ed8;
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        /* CHAMPS DATES */
        .search-field input:not(.location-input):not(.voyageurs-display) {
            border: none;
            background: transparent;
            color: #1f2937;
            font-size: 16px;
            font-weight: 500;
            font-family: 'Inter', sans-serif;
            outline: none;
            width: 100%;
            padding: 0;
        }

        .search-field input::placeholder {
            color: #9ca3af;
            font-weight: 400;
        }

        /* SÉLECTEUR VOYAGEURS AMÉLIORÉ */
        .guests-field {
            position: relative;
            flex: 1.5;
            flex-shrink: 0;
            min-width: 200px;
            overflow: visible;
        }

        .voyageurs-dropdown {
            position: relative;
        }

        .voyageurs-display {
            border: none !important;
            background: transparent !important;
            color: #1f2937 !important;
            font-size: 16px !important;
            font-weight: 500 !important;
            font-family: 'Inter', sans-serif !important;
            outline: none !important;
            width: 100% !important;
            padding: 0 !important;
            cursor: pointer !important;
        }

        /* DROPDOWN MENU VOYAGEURS AMÉLIORÉ */
        .guests-dropdown {
            position: fixed;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            z-index: 999999;
            display: none;
            width: 320px;
            min-width: 320px;
        }
        
        .guests-dropdown.active {
            display: block;
        }
        
        .guest-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }
        
        .guest-row:last-child {
            border-bottom: none;
        }
        
        .guest-info {
            flex: 1;
        }
        
        .guest-type {
            font-weight: 600;
            color: #333;
            margin-bottom: 2px;
            font-size: 14px;
        }
        
        .guest-description {
            font-size: 12px;
            color: #666;
        }
        
        .guest-counter {
            display: flex;
            align-items: center;
            gap: 16px;
            flex-shrink: 0;
        }
        
        .counter-btn {
            width: 36px;
            height: 36px;
            border: 2px solid #0071c2;
            background: white;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #0071c2;
            transition: all 0.3s ease;
            font-size: 16px;
            flex-shrink: 0;
        }
        
        .counter-btn:hover {
            background: #0071c2;
            color: white;
        }
        
        .counter-btn:disabled {
            border-color: #ccc;
            color: #ccc;
            cursor: not-allowed;
        }
        
        .counter-btn:disabled:hover {
            background: white;
            color: #ccc;
        }
        
        .counter-value {
            font-weight: 600;
            color: #333;
            min-width: 24px;
            text-align: center;
            font-size: 16px;
            flex-shrink: 0;
        }

        .voyageur-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.06);
        }

        .voyageur-row:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .voyageur-info {
            flex: 1;
        }

        .voyageur-label {
            display: block;
            font-family: 'Inter', sans-serif;
            font-weight: 600;
            font-size: 16px;
            color: #1f2937;
            margin-bottom: 2px;
        }

        .voyageur-info small {
            color: #6b7280;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            font-weight: 400;
        }

        /* COMPTEURS VOYAGEURS */
        .voyageur-counter {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .counter-btn {
            background: #ffffff;
            border: 2px solid #e5e7eb;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            color: #6b7280;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 600;
            font-size: 18px;
        }

        .counter-btn:hover:not(:disabled) {
            border-color: #3b82f6;
            color: #3b82f6;
            transform: scale(1.05);
        }

        .counter-btn:disabled {
            background: #f9fafb;
            color: #d1d5db;
            cursor: not-allowed;
            transform: none;
        }

        .counter-value {
            min-width: 40px;
            text-align: center;
            font-weight: 600;
            font-size: 16px;
            color: #1f2937;
            font-family: 'Inter', sans-serif;
        }

        /* BOUTON RECHERCHER */
        .search-btn {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            border: none;
            color: white;
            padding: 16px 32px;
            border-radius: 12px;
            font-family: 'Inter', sans-serif;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            white-space: nowrap;
        }

        .search-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 12px 24px rgba(59, 130, 246, 0.3);
        }

        /* RESPONSIVE */
        @media (max-width: 1024px) {
            .villa-search-form {
                flex-wrap: wrap;
                gap: 8px;
            }
            
            .search-field {
                min-width: 180px;
                border-right: none;
                border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            }
            
            .search-field:last-child {
                border-bottom: none;
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 768px) {
            .villa-search-form {
                flex-direction: column;
                padding: 16px;
            }
            
            .search-field {
                border: none;
                border-bottom: 1px solid rgba(0, 0, 0, 0.1);
                min-width: auto;
                padding: 16px 0;
            }
            
            .search-field:last-child {
                border-bottom: none;
                padding-top: 20px;
            }
            
            .voyageurs-menu {
                left: -16px;
                right: -16px;
            }
            
            .location-suggestions {
                left: -16px;
                right: -16px;
            }
        }
        
        /* ===== FIN BARRE DE RECHERCHE STYLE BOOKING.COM ===== */
        
        .search-field {
            padding: 16px 20px;
            border: none;
            background: transparent;
            border-right: 1px solid rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-width: 200px;
            flex: 1;
        }
        
        .search-field:last-of-type {
            border-right: none;
        }
        
        .search-field:hover {
            background: rgba(0, 0, 0, 0.02);
        }
        
        .search-field-label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .search-field input, .search-field select {
            border: none;
            background: transparent;
            font-size: 14px;
            color: #666;
            font-weight: 500;
            width: 100%;
            outline: none;
        }
        
        .search-button {
            background: linear-gradient(135deg, #0071c2 0%, #004d8b 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px 24px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-left: 8px;
            flex-shrink: 0;
            min-width: 120px;
        }
        
        .search-button:hover {
            background: linear-gradient(135deg, #005999 0%, #003d6b 100%);
            transform: translateY(-1px);
        }
        
        /* Villa Grid */
        .villas-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        /* Filters */
        .filters {
            display: flex;
            gap: 1rem;
            margin: 2rem 0;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .filter-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 8px 16px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .filter-btn.active, .filter-btn:hover {
            background: #FFA500;
            border-color: #FFA500;
        }
        
        /* Image Placeholder */
        .image-placeholder {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
            border-radius: 15px 15px 0 0;
            cursor: pointer;
        }
        
        /* Modals */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }
        
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            margin: 15% auto;
            padding: 2rem;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        .close {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 28px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        
        .close:hover {
            color: #000;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #FFA500;
        }
        
        .price-summary {
            background: rgba(255, 165, 0, 0.1);
            border: 2px solid #FFA500;
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .price-summary h3 {
            color: #333;
            margin-bottom: 1rem;
        }
        
        .price-line {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }
        
        .price-total {
            font-weight: bold;
            font-size: 1.2rem;
            border-top: 2px solid #FFA500;
            padding-top: 0.5rem;
            margin-top: 1rem;
        }
        
        /* Gallery Modal */
        .image-gallery-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(5px);
        }
        
        .image-gallery-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .gallery-content {
            position: relative;
            width: 90%;
            height: 90%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .gallery-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 10px;
        }
        
        .gallery-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: none;
            color: white;
            font-size: 2rem;
            padding: 1rem;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .gallery-nav:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-50%) scale(1.1);
        }
        
        .gallery-prev {
            left: 20px;
        }
        
        .gallery-next {
            right: 20px;
        }
        
        .gallery-close {
            position: absolute;
            top: 20px;
            right: 30px;
            color: white;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .gallery-thumbnails {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 10px;
            max-width: 80%;
            overflow-x: auto;
        }
        
        .thumbnail {
            width: 60px;
            height: 40px;
            object-fit: cover;
            border-radius: 5px;
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.3s ease;
        }
        
        .thumbnail.active, .thumbnail:hover {
            opacity: 1;
        }
        
        /* Status Messages */
        .status-message {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            color: rgba(34, 197, 94, 1);
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        
        .loading {
            background: rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
            color: rgba(59, 130, 246, 1);
        }
        
        .error {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.3);
            color: rgba(239, 68, 68, 1);
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .villa-card {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .nav-links {
                justify-content: center;
                gap: 0.5rem;
            }
            
            .nav-links a {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }
            
            .section h1 {
                font-size: 2rem;
            }
            
            .booking-search-container {
                flex-direction: column;
                gap: 0;
            }
            
            .search-field {
                border-right: none;
                border-bottom: 1px solid rgba(0, 0, 0, 0.1);
                min-width: 100%;
            }
            
            .search-field:last-of-type {
                border-bottom: none;
            }
            
            .search-button {
                margin-left: 0;
                margin-top: 12px;
                width: 100%;
            }
            
            .villas-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .villa-card {
                height: auto;
                min-height: 450px;
            }
            
            .modal-content {
                width: 95%;
                margin: 5% auto;
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Background Video Cloudinary -->
    <div class="video-background">
        <video autoplay muted loop playsinline preload="auto">
            <source src="https://res.cloudinary.com/ddulasmtz/video/upload/v1752950782/background-video.mp4_qoofsz.mp4" type="video/mp4">
            Votre navigateur ne supporte pas la lecture de vidéos HTML5.
        </video>
        <div class="video-overlay"></div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo" onclick="showSection('home')">
                <i class="fas fa-palm-tree"></i>
                KhanelConcept
            </div>
            
            <nav class="nav-links">
                <a href="#" onclick="showSection('home')" class="active" id="nav-home">Accueil</a>
                <a href="#" onclick="showSection('prestataires')" id="nav-prestataires">Prestataires</a>
                <a href="#" onclick="showSection('billetterie')" id="nav-billetterie">Billetterie</a>
                <a href="#" onclick="showSection('mobilier')" id="nav-mobilier">Mobilier</a>
                <a href="#" onclick="showSection('excursions')" id="nav-excursions">Excursions</a>
                <a href="#" onclick="showSection('comptes')" id="nav-comptes">Comptes</a>
                <a href="#" onclick="showSection('fidelite')" id="nav-fidelite">Fidélité</a>
                <a href="#" onclick="showSection('pmr')" id="nav-pmr">PMR</a>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Section Accueil -->
        <section id="home" class="section active">
            <div class="container">
                <h1>🏝️ Découvrez la Martinique</h1>
                <p>21 villas de luxe et services exceptionnels dans un cadre paradisiaque</p>
                
                <!-- Recherche Style Booking.com Complète -->
                <div class="search-section">
                    <h2>🔍 Rechercher une Villa</h2>
                    <div class="villa-search-form">
                        <!-- Destination -->
                        <div class="search-field location-field">
                            <label for="location-search">DESTINATION</label>
                            <input type="text" 
                                   id="location-search" 
                                   class="location-input"
                                   placeholder="Où souhaitez-vous aller ?"
                                   autocomplete="off"
                                   oninput="handleLocationInput(this.value)"
                                   onfocus="showLocationSuggestions(true)">
                            <div class="location-suggestions" id="suggestions-dropdown"></div>
                        </div>
                        
                        <!-- Arrivée avec calendrier -->
                        <div class="search-field">
                            <label for="checkin">ARRIVÉE</label>
                            <input type="text" id="checkin" placeholder="Ajouter des dates">
                        </div>
                        
                        <!-- Départ avec calendrier -->
                        <div class="search-field">
                            <label for="checkout">DÉPART</label>
                            <input type="text" id="checkout" placeholder="Ajouter des dates">
                        </div>
                        
                        <!-- Voyageurs -->
                        <div class="search-field guests-field">
                            <label>VOYAGEURS</label>
                            <div class="voyageurs-dropdown">
                                <input type="text" 
                                       class="voyageurs-display" 
                                       value="2 adultes"
                                       readonly
                                       onclick="toggleVoyageursDropdown()">
                                
                                <div class="dropdown-menu guests-dropdown" id="voyageurs-menu">
                                    <!-- Adultes -->
                                    <div class="guest-row">
                                        <div class="guest-info">
                                            <div class="guest-type">Adultes</div>
                                            <div class="guest-description">13 ans et plus</div>
                                        </div>
                                        <div class="guest-counter">
                                            <button type="button" class="counter-btn minus" onclick="updateVoyageurs('adultes', -1)">-</button>
                                            <span class="counter-value" id="adultes-count">2</span>
                                            <button type="button" class="counter-btn plus" onclick="updateVoyageurs('adultes', 1)">+</button>
                                        </div>
                                    </div>
                                    
                                    <!-- Enfants -->
                                    <div class="guest-row">
                                        <div class="guest-info">
                                            <div class="guest-type">Enfants</div>
                                            <div class="guest-description">De 2 à 12 ans</div>
                                        </div>
                                        <div class="guest-counter">
                                            <button type="button" class="counter-btn minus" onclick="updateVoyageurs('enfants', -1)">-</button>
                                            <span class="counter-value" id="enfants-count">0</span>
                                            <button type="button" class="counter-btn plus" onclick="updateVoyageurs('enfants', 1)">+</button>
                                        </div>
                                    </div>
                                    
                                    <!-- Bébés -->
                                    <div class="guest-row">
                                        <div class="guest-info">
                                            <div class="guest-type">Bébés</div>
                                            <div class="guest-description">Moins de 2 ans</div>
                                        </div>
                                        <div class="guest-counter">
                                            <button type="button" class="counter-btn minus" onclick="updateVoyageurs('bebes', -1)">-</button>
                                            <span class="counter-value" id="bebes-count">0</span>
                                            <button type="button" class="counter-btn plus" onclick="updateVoyageurs('bebes', 1)">+</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bouton Rechercher -->
                        <div class="search-field">
                            <button class="search-btn" onclick="performSearch()">
                                <i class="fas fa-search"></i>
                                Rechercher
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Filtres -->
                <div class="filters">
                    <button class="filter-btn active" onclick="filterVillas('all')">Toutes</button>
                    <button class="filter-btn" onclick="filterVillas('sejour')">Séjour</button>
                    <button class="filter-btn" onclick="filterVillas('fete')">Fête/Journée</button>
                    <button class="filter-btn" onclick="filterVillas('special')">Spéciales</button>
                </div>
                
                <h2>🏖️ Nos 21 Villas de Luxe</h2>
                <div class="status-message" id="status-message" style="display: none;"></div>
                <div class="villas-grid" id="villasGrid">
                    <!-- Les villas seront chargées dynamiquement -->
                </div>
            </div>
        </section>

        <!-- Section Prestataires -->
        <section id="prestataires" class="section">
            <div class="container">
                <h1>🌊 Nos Prestataires de Services</h1>
                <p>Explorez nos services nautiques, culinaires et événementiels</p>
                
                <div class="villas-grid">
                    <div class="glass-card">
                        <h3>🚤 Excursions Nautiques</h3>
                        <p>Découvrez la beauté de la Martinique depuis la mer avec nos excursions en catamaran.</p>
                        <div class="price">À partir de 120€/personne</div>
                        <button class="btn-primary" onclick="contactPrestataire('nautique')">Réserver</button>
                    </div>
                    
                    <div class="glass-card">
                        <h3>🍽️ Services Culinaires</h3>
                        <p>Savourez la cuisine créole authentique avec nos chefs professionnels.</p>
                        <div class="price">À partir de 80€/personne</div>
                        <button class="btn-primary" onclick="contactPrestataire('culinaire')">Réserver</button>
                    </div>
                    
                    <div class="glass-card">
                        <h3>🎉 Organisation d'Événements</h3>
                        <p>Confiez-nous l'organisation de vos événements mémorables.</p>
                        <div class="price">Devis personnalisé</div>
                        <button class="btn-primary" onclick="contactPrestataire('evenements')">Demander un devis</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Autres sections -->
        <section id="billetterie" class="section">
            <div class="container">
                <h1>🎫 Billetterie Événementielle</h1>
                <p>Organisez et participez aux meilleurs événements de Martinique</p>
                <div class="glass-card">
                    <h3>🎭 Événements à Venir</h3>
                    <p>Découvrez notre programmation d'événements culturels et festifs.</p>
                    <button class="btn-primary" onclick="showComingSoon()">Voir les événements</button>
                </div>
            </div>
        </section>

        <section id="mobilier" class="section">
            <div class="container">
                <h1>🛋️ Location de Mobilier</h1>
                <p>Tables, chaises, décoration pour vos événements</p>
                <div class="glass-card">
                    <h3>🪑 Mobilier d'Événement</h3>
                    <p>Location de mobilier haut de gamme pour tous vos événements.</p>
                    <button class="btn-primary" onclick="contactPrestataire('mobilier')">Demander un devis</button>
                </div>
            </div>
        </section>

        <section id="excursions" class="section">
            <div class="container">
                <h1>⛵ Excursions Inoubliables</h1>
                <p>Découvrez la Martinique par terre, mer et air</p>
                <div class="glass-card">
                    <h3>🏝️ Tours de l'Île</h3>
                    <p>Explorez les merveilles cachées de la Martinique avec nos guides experts.</p>
                    <button class="btn-primary" onclick="contactPrestataire('excursions')">Réserver</button>
                </div>
            </div>
        </section>

        <section id="comptes" class="section">
            <div class="container">
                <h1>🐷 Comptes Vacances & Abonnements</h1>
                <p>Épargnez pour vos futures vacances avec nos comptes dédiés</p>
                <div class="glass-card">
                    <h3>💰 Épargne Vacances</h3>
                    <p>Constituez votre épargne pour des vacances de rêve en Martinique.</p>
                    <button class="btn-primary" onclick="showComingSoon()">En savoir plus</button>
                </div>
            </div>
        </section>

        <section id="fidelite" class="section">
            <div class="container">
                <h1>🎁 Programme de Fidélité</h1>
                <p>Gagnez des points et des récompenses à chaque réservation</p>
                <div class="glass-card">
                    <h3>⭐ Rewards Club</h3>
                    <p>Rejoignez notre programme de fidélité et bénéficiez d'avantages exclusifs.</p>
                    <button class="btn-primary" onclick="showComingSoon()">Rejoindre</button>
                </div>
            </div>
        </section>

        <section id="pmr" class="section">
            <div class="container">
                <h1>👑 Accessibilité PMR</h1>
                <p>Des séjours adaptés pour tous</p>
                <div class="glass-card">
                    <h3>♿ Villas Accessibles</h3>
                    <p>Découvrez nos villas spécialement aménagées pour les personnes à mobilité réduite.</p>
                    <button class="btn-primary" onclick="filterVillas('pmr')">Voir les villas PMR</button>
                </div>
            </div>
        </section>
    </main>

    <!-- Modal de réservation -->
    <div id="reservationModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeReservationModal()">&times;</span>
            <h2 id="modalVillaName">Réservation Villa</h2>
            
            <form id="reservationForm">
                <div class="form-group">
                    <label for="customerName">Nom complet *</label>
                    <input type="text" id="customerName" required>
                </div>
                
                <div class="form-group">
                    <label for="customerEmail">Email *</label>
                    <input type="email" id="customerEmail" required>
                </div>
                
                <div class="form-group">
                    <label for="customerPhone">Téléphone *</label>
                    <input type="tel" id="customerPhone" required>
                </div>
                
                <div style="display: flex; gap: 1rem;">
                    <div class="form-group" style="flex: 1;">
                        <label for="modalCheckin">Date d'arrivée *</label>
                        <input type="text" id="modalCheckin" required>
                    </div>
                    
                    <div class="form-group" style="flex: 1;">
                        <label for="modalCheckout">Date de départ *</label>
                        <input type="text" id="modalCheckout" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="modalGuests">Nombre de voyageurs *</label>
                    <select id="modalGuests" required>
                        <option value="">Choisir le nombre</option>
                        <option value="2">2 personnes</option>
                        <option value="4">4 personnes</option>
                        <option value="6">6 personnes</option>
                        <option value="8">8 personnes</option>
                        <option value="10">10 personnes</option>
                        <option value="15">15+ personnes</option>
                    </select>
                </div>
                
                <div id="priceCalculation" class="price-summary" style="display: none;">
                    <h3>📋 Résumé de la réservation</h3>
                    <div class="price-line">
                        <span>Villa :</span>
                        <span id="summaryVillaName">-</span>
                    </div>
                    <div class="price-line">
                        <span>Dates :</span>
                        <span id="summaryDates">-</span>
                    </div>
                    <div class="price-line">
                        <span>Nombre de nuits :</span>
                        <span id="summaryNights">-</span>
                    </div>
                    <div class="price-line">
                        <span>Prix par nuit :</span>
                        <span id="summaryPricePerNight">-</span>
                    </div>
                    <div class="price-line price-total">
                        <span>Total :</span>
                        <span id="summaryTotal">-</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="customerMessage">Message ou demandes spéciales</label>
                    <textarea id="customerMessage" rows="3" placeholder="Décrivez vos besoins particuliers..."></textarea>
                </div>
                
                <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button type="button" onclick="closeReservationModal()" class="btn-secondary" style="flex: 1;">Annuler</button>
                    <button type="submit" class="btn-primary" style="flex: 2;">
                        <i class="fas fa-calendar-check"></i>
                        Confirmer la réservation
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de galerie d'images -->
    <div id="imageGalleryModal" class="image-gallery-modal">
        <div class="gallery-content">
            <span class="gallery-close" onclick="closeImageGallery()">&times;</span>
            <button class="gallery-nav gallery-prev" onclick="previousImage()">❮</button>
            <img id="galleryImage" class="gallery-image" src="" alt="">
            <button class="gallery-nav gallery-next" onclick="nextImage()">❯</button>
            
            <div class="gallery-thumbnails" id="galleryThumbnails">
                <!-- Les miniatures seront générées dynamiquement -->
            </div>
        </div>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/fr.js"></script>

    <script>
        // Base de données COMPLÈTE des 21 villas avec chemins d'images corrigés
        const villasData = [
            // === VILLAS DE SÉJOUR ===
            {
                id: 1,
                name: "Villa F3 Petit Macabou",
                location: "Petit Macabou au Vauclin",
                price: 850,
                guests: 6,
                guestsDetail: "6 personnes + 9 invités",
                features: "Sauna, Jacuzzi, 2 douches extérieures",
                category: "sejour",
                image: "./images/Villa_F3_Petit_Macabou/01_piscine_exterieur.jpg",
                gallery: [
                    "./images/Villa_F3_Petit_Macabou/01_piscine_exterieur.jpg",
                    "./images/Villa_F3_Petit_Macabou/02_terrasse_salon_exterieur.jpg",
                    "./images/Villa_F3_Petit_Macabou/03_salle_de_bain_moderne.jpg",
                    "./images/Villa_F3_Petit_Macabou/04_chambre_principale.jpg",
                    "./images/Villa_F3_Petit_Macabou/05_cuisine_equipee.jpg",
                    "./images/Villa_F3_Petit_Macabou/07_sauna_detente.jpg",
                    "./images/Villa_F3_Petit_Macabou/08_douche_exterieure.jpg"
                ],
                fallbackIcon: "🏊"
            },
            {
                id: 2,
                name: "Villa F5 Ste Anne",
                location: "Quartier Les Anglais, Ste Anne",
                price: 1300,
                guests: 10,
                guestsDetail: "10 personnes + 15 invités",
                features: "Piscine, décoration rose distinctive",
                category: "sejour",
                image: "./images/Villa_F5_Ste_Anne/01_piscine_principale.jpg",
                gallery: [
                    "./images/Villa_F5_Ste_Anne/01_piscine_principale.jpg",
                    "./images/Villa_F5_Ste_Anne/02_piscine_vue_aerienne.jpg",
                    "./images/Villa_F5_Ste_Anne/03_facade_villa_rose.jpg",
                    "./images/Villa_F5_Ste_Anne/04_cuisine_moderne.jpg",
                    "./images/Villa_F5_Ste_Anne/05_salon_principal.jpg",
                    "./images/Villa_F5_Ste_Anne/06_chambre_principale.jpg"
                ],
                fallbackIcon: "🌸"
            },
            {
                id: 3,
                name: "Villa F3 Baccha Petit Macabou",
                location: "Petit Macabou",
                price: 1350,
                guests: 6,
                guestsDetail: "6 personnes + 9 convives",
                features: "Piscine, terrasses modernes",
                category: "sejour",
                image: "./images/Villa_F3_Baccha_Petit_Macabou/01_terrasse_piscine_salon_ext.jpg",
                gallery: [
                    "./images/Villa_F3_Baccha_Petit_Macabou/01_terrasse_piscine_salon_ext.jpg",
                    "./images/Villa_F3_Baccha_Petit_Macabou/02_terrasse_piscine_angle.jpg",
                    "./images/Villa_F3_Baccha_Petit_Macabou/03_chambre_moderne.jpg",
                    "./images/Villa_F3_Baccha_Petit_Macabou/04_terrasse_jardin.jpg",
                    "./images/Villa_F3_Baccha_Petit_Macabou/05_cuisine_equipee.jpg",
                    "./images/Villa_F3_Baccha_Petit_Macabou/06_chambre_2.jpg"
                ],
                fallbackIcon: "🏖️"
            },
            {
                id: 4,
                name: "Villa F6 Lamentin",
                location: "Quartier Bélème au Lamentin",
                price: 1500,
                guests: 10,
                guestsDetail: "10 personnes + 20 invités max",
                features: "Piscine, Jacuzzi, douche extérieure",
                category: "sejour",
                image: "./images/Villa_F6_Lamentin/01_piscine_jacuzzi_vue_ensemble.jpg",
                gallery: [
                    "./images/Villa_F6_Lamentin/01_piscine_jacuzzi_vue_ensemble.jpg"
                ],
                fallbackIcon: "🛁"
            },
            {
                id: 5,
                name: "Villa F6 Ste Luce Plage",
                location: "Zac de Pont Café, Ste Luce",
                price: 1700,
                guests: 14,
                guestsDetail: "10 à 14 personnes",
                features: "Piscine, 1 minute de la plage",
                category: "sejour",
                image: "./images/Villa_F6_Ste_Luce_Plage/02_chambre_poutres.jpg",
                gallery: [
                    "./images/Villa_F6_Ste_Luce_Plage/02_chambre_poutres.jpg",
                    "./images/Villa_F6_Ste_Luce_Plage/03_cuisine_moderne.jpg",
                    "./images/Villa_F6_Ste_Luce_Plage/04_salle_a_manger.jpg",
                    "./images/Villa_F6_Ste_Luce_Plage/05_vue_aerienne_piscine.jpg",
                    "./images/Villa_F6_Ste_Luce_Plage/06_salon_piscine.jpg"
                ],
                fallbackIcon: "🏖️"
            },
            {
                id: 6,
                name: "Villa F6 Petit Macabou",
                location: "Petit Macabou au Vauclin",
                price: 2000,
                guests: 13,
                guestsDetail: "10 à 13 personnes (14 max)",
                features: "Piscine, fêtes jusqu'à 150 convives",
                category: "sejour",
                image: "./images/Villa_F6_Petit_Macabou/02_salle_de_bain.jpg",
                gallery: [
                    "./images/Villa_F6_Petit_Macabou/02_salle_de_bain.jpg",
                    "./images/Villa_F6_Petit_Macabou/03_chambre_studio.jpg",
                    "./images/Villa_F6_Petit_Macabou/04_salon_mezzanine.jpg",
                    "./images/Villa_F6_Petit_Macabou/05_cuisine_moderne.jpg",
                    "./images/Villa_F6_Petit_Macabou/06_terrasse_couverte.jpg",
                    "./images/Villa_F6_Petit_Macabou/07_terrasse_piscine.jpg",
                    "./images/Villa_F6_Petit_Macabou/10_vue_aerienne_jour.jpg"
                ],
                fallbackIcon: "🎊"
            },
            {
                id: 7,
                name: "Villa F7 Baie des Mulets",
                location: "Baie des Mulets, Vauclin",
                price: 2200,
                guests: 16,
                guestsDetail: "16 personnes (F5 + F3)",
                features: "Véranda bambou, fêtes 160 convives",
                category: "sejour",
                image: "./images/Villa_F7_Baie_des_Mulets_Vauclin/veranda_salle_a_manger_bambou.jpg",
                gallery: [
                    "./images/Villa_F7_Baie_des_Mulets_Vauclin/veranda_salle_a_manger_bambou.jpg",
                    "./images/Villa_F7_Baie_des_Mulets_Vauclin/salon_canape_angle_gris.jpg",
                    "./images/Villa_F7_Baie_des_Mulets_Vauclin/chambre_principale_bleu_jaune.jpg",
                    "./images/Villa_F7_Baie_des_Mulets_Vauclin/cuisine_moderne_blanche.jpg",
                    "./images/Villa_F7_Baie_des_Mulets_Vauclin/coin_detente_fauteuils_suspendus.jpg"
                ],
                fallbackIcon: "🎋"
            },
            {
                id: 8,
                name: "Villa F3 Trinité (Cosmy)",
                location: "Cosmy, Trinité Martinique",
                price: 670,
                guests: 5,
                guestsDetail: "5 adultes ou 4 adultes + 2 enfants",
                features: "Piscine chauffée privée, vue mer",
                category: "sejour",
                image: "./images/Villa_F3_Trinite_Cosmy/piscine_chauffee_vue_collines.jpg",
                gallery: [
                    "./images/Villa_F3_Trinite_Cosmy/piscine_chauffee_vue_collines.jpg",
                    "./images/Villa_F3_Trinite_Cosmy/piscine_vue_panoramique_ocean.jpg",
                    "./images/Villa_F3_Trinite_Cosmy/salon_canape_angle_marron_coussins_turquoise.jpg",
                    "./images/Villa_F3_Trinite_Cosmy/cuisine_americaine_jaune_bois.jpg",
                    "./images/Villa_F3_Trinite_Cosmy/chambre_1_linge_tropical_turquoise.jpg",
                    "./images/Villa_F3_Trinite_Cosmy/chambre_2_bleu_blanc_tapis_moelleux.jpg"
                ],
                fallbackIcon: "🌊"
            },
            {
                id: 9,
                name: "Villa F3 Le Robert",
                location: "Pointe Hyacinthe, Robert",
                price: 750,
                guests: 10,
                guestsDetail: "10 personnes",
                features: "Piscine rectangulaire, kitchenette ext.",
                category: "sejour",
                image: "./images/Villa_F3_Robert_Pointe_Hyacinthe/piscine_rectangulaire_moderne.jpg",
                gallery: [
                    "./images/Villa_F3_Robert_Pointe_Hyacinthe/piscine_rectangulaire_moderne.jpg",
                    "./images/Villa_F3_Robert_Pointe_Hyacinthe/terrasse_couverte_pergola_kitchenette.jpg",
                    "./images/Villa_F3_Robert_Pointe_Hyacinthe/salon_salle_a_manger_tv.jpg",
                    "./images/Villa_F3_Robert_Pointe_Hyacinthe/cuisine_ouverte_plan_travail.jpg",
                    "./images/Villa_F3_Robert_Pointe_Hyacinthe/cuisine_equipee_frigo_congelateur.jpg"
                ],
                fallbackIcon: "🏊"
            },
            {
                id: 10,
                name: "Villa F5 R.Pilote",
                location: "Quartier La Renée, Rivière-Pilote",
                price: 900,
                guests: 10,
                guestsDetail: "10 personnes + 60 invités",
                features: "Piscine, Jacuzzi, terrasse hamacs",
                category: "sejour",
                image: "./images/Villa_F5_R_Pilote_La_Renee/piscine_terrasse_bois_palmiers.jpg",
                gallery: [
                    "./images/Villa_F5_R_Pilote_La_Renee/piscine_terrasse_bois_palmiers.jpg",
                    "./images/Villa_F5_R_Pilote_La_Renee/terrasse_hamacs_salon_exterieur.jpg",
                    "./images/Villa_F5_R_Pilote_La_Renee/salon_cuir_noir_plafond_vert.jpg",
                    "./images/Villa_F5_R_Pilote_La_Renee/cuisine_equipee_bois_clair.jpg"
                ],
                fallbackIcon: "🏖️"
            },
            {
                id: 11,
                name: "Villa F3 Le François",
                location: "Le François, Martinique",
                price: 950,
                guests: 6,
                guestsDetail: "6 personnes",
                features: "Piscine, terrasse vue mer panoramique",
                category: "sejour",
                image: "./images/Villa_F3_Le_Francois/01_terrasse_piscine_vue_mer.jpg",
                gallery: [
                    "./images/Villa_F3_Le_Francois/01_terrasse_piscine_vue_mer.jpg",
                    "./images/Villa_F3_Le_Francois/02_terrasse_repas_vue_panoramique.jpg",
                    "./images/Villa_F3_Le_Francois/03_salon_exterieur_detente.jpg",
                    "./images/Villa_F3_Le_Francois/04_chambre_bleue_moderne.jpg",
                    "./images/Villa_F3_Le_Francois/05_cuisine_bleue_equipee.jpg",
                    "./images/Villa_F3_Le_Francois/06_salon_colore_deco.jpg",
                    "./images/Villa_F3_Le_Francois/07_vue_aerienne_villa.jpg"
                ],
                fallbackIcon: "🌅"
            },
            {
                id: 12,
                name: "Villa F5 Vauclin Ravine Plate",
                location: "Ravine Plate, Vauclin",
                price: 1200,
                guests: 10,
                guestsDetail: "10 personnes",
                features: "Piscine à débordement, vue panoramique",
                category: "sejour",
                image: "./images/Villa_F5_Vauclin_Ravine_Plate/piscine_a_debordement_vue_panoramique.jpg",
                gallery: [
                    "./images/Villa_F5_Vauclin_Ravine_Plate/piscine_a_debordement_vue_panoramique.jpg",
                    "./images/Villa_F5_Vauclin_Ravine_Plate/terrasse_panoramique_gazebo_vue_collines.jpg",
                    "./images/Villa_F5_Vauclin_Ravine_Plate/salon_moderne_rouge_noir_escalier.jpg",
                    "./images/Villa_F5_Vauclin_Ravine_Plate/cuisine_equipee_bois_fonce_granite.jpg",
                    "./images/Villa_F5_Vauclin_Ravine_Plate/chambre_1_poutres_apparentes_orange.jpg",
                    "./images/Villa_F5_Vauclin_Ravine_Plate/chambre_2_suite_parentale_sdb_attenante.jpg"
                ],
                fallbackIcon: "🏔️"
            },
            {
                id: 13,
                name: "Bas Villa F3 Ste Luce",
                location: "Sainte-Luce",
                price: 470,
                guests: 4,
                guestsDetail: "4 personnes",
                features: "Terrasse couverte, éclairage LED",
                category: "sejour",
                image: "./images/Bas_Villa_F3_Ste_Luce/01_chambre_salle_a_manger.jpg",
                gallery: [
                    "./images/Bas_Villa_F3_Ste_Luce/01_chambre_salle_a_manger.jpg",
                    "./images/Bas_Villa_F3_Ste_Luce/02_salle_de_bain_moderne.jpg",
                    "./images/Bas_Villa_F3_Ste_Luce/03_salon_tv_eclairage_led.jpg",
                    "./images/Bas_Villa_F3_Ste_Luce/05_terrasse_eclairage_ambiance.jpg",
                    "./images/Bas_Villa_F3_Ste_Luce/06_chambre_climatisee.jpg",
                    "./images/Bas_Villa_F3_Ste_Luce/08_terrasse_lounge.jpg"
                ],
                fallbackIcon: "💡"
            },
            {
                id: 14,
                name: "Villa F3 Trenelle",
                location: "Trenelle, Location Annuelle",
                price: 800,
                guests: 6,
                guestsDetail: "6 personnes",
                features: "Location longue durée, entièrement équipée",
                category: "sejour",
                image: "./images/Villa_F3_Trenelle_Location_Annuelle/01_salon_salle_a_manger.jpg",
                gallery: [
                    "./images/Villa_F3_Trenelle_Location_Annuelle/01_salon_salle_a_manger.jpg",
                    "./images/Villa_F3_Trenelle_Location_Annuelle/02_espace_detente.jpg",
                    "./images/Villa_F3_Trenelle_Location_Annuelle/03_salon_television.jpg",
                    "./images/Villa_F3_Trenelle_Location_Annuelle/04_couloir_entree.jpg",
                    "./images/Villa_F3_Trenelle_Location_Annuelle/05_cuisine_equipee.jpg",
                    "./images/Villa_F3_Trenelle_Location_Annuelle/06_cuisine_evier.jpg"
                ],
                fallbackIcon: "🏠"
            },

            // === VILLAS SPÉCIALES ===
            {
                id: 15,
                name: "Studio Cocooning Lamentin",
                location: "Morne Pitault, Lamentin",
                price: 290,
                guests: 2,
                guestsDetail: "2 personnes (couple)",
                features: "Jacuzzi privé, vue panoramique",
                category: "special",
                image: "./images/Studio_Cocooning_Lamentin/01_studio_vue_ensemble.jpg",
                gallery: [
                    "./images/Studio_Cocooning_Lamentin/01_studio_vue_ensemble.jpg",
                    "./images/Studio_Cocooning_Lamentin/02_cuisine_moderne.jpg",
                    "./images/Studio_Cocooning_Lamentin/03_terrasse_jacuzzi.jpg",
                    "./images/Studio_Cocooning_Lamentin/04_cuisine_ouverte.jpg",
                    "./images/Studio_Cocooning_Lamentin/05_chambre_salon.jpg",
                    "./images/Studio_Cocooning_Lamentin/07_chambre_mur_vert.jpg"
                ],
                fallbackIcon: "💕"
            },
            {
                id: 16,
                name: "Espace Piscine Journée Bungalow",
                location: "Martinique",
                price: 150,
                guests: 8,
                guestsDetail: "8 personnes en journée",
                features: "Bungalow créole, piscine, véranda",
                category: "special",
                image: "./images/Espace_Piscine_Journee_Bungalow/bungalow_exterieur_veranda_creole.jpg",
                gallery: [
                    "./images/Espace_Piscine_Journee_Bungalow/bungalow_exterieur_veranda_creole.jpg",
                    "./images/Espace_Piscine_Journee_Bungalow/bungalow_interieur_studio_kitchenette.jpg"
                ],
                fallbackIcon: "🏕️"
            },

            // === VILLAS FÊTE/JOURNÉE ===
            {
                id: 17,
                name: "Villa Fête Ducos",
                location: "Ducos, Martinique",
                price: 200,
                guests: 25,
                guestsDetail: "Jusqu'à 25 personnes",
                features: "Piscine, bar extérieur, gazebo",
                category: "fete",
                image: "./images/Villa_Fete_Journee_Ducos/01_piscine_jouets_gonflables.jpg",
                gallery: [
                    "./images/Villa_Fete_Journee_Ducos/01_piscine_jouets_gonflables.jpg",
                    "./images/Villa_Fete_Journee_Ducos/02_terrasse_couverte_salon.jpg",
                    "./images/Villa_Fete_Journee_Ducos/03_bar_exterieur_gazebo.jpg",
                    "./images/Villa_Fete_Journee_Ducos/04_piscine_mobilier_exterieur.jpg",
                    "./images/Villa_Fete_Journee_Ducos/05_espace_repas_piscine.jpg",
                    "./images/Villa_Fete_Journee_Ducos/06_jardin_parasol_detente.jpg"
                ],
                fallbackIcon: "🎉"
            },
            {
                id: 18,
                name: "Villa Fête Fort-de-France",
                location: "Fort-de-France, Martinique",
                price: 250,
                guests: 30,
                guestsDetail: "Jusqu'à 30 personnes",
                features: "Piscine, véranda coloniale, vue panoramique",
                category: "fete",
                image: "./images/Villa_Fete_Journee_Fort_de_France/01_piscine_vue_panoramique.jpg",
                gallery: [
                    "./images/Villa_Fete_Journee_Fort_de_France/01_piscine_vue_panoramique.jpg",
                    "./images/Villa_Fete_Journee_Fort_de_France/02_piscine_statues_buddha.jpg",
                    "./images/Villa_Fete_Journee_Fort_de_France/03_terrasse_colonnes_vue.jpg",
                    "./images/Villa_Fete_Journee_Fort_de_France/04_veranda_arches_coloniales.jpg",
                    "./images/Villa_Fete_Journee_Fort_de_France/05_cuisine_moderne_equipee.jpg"
                ],
                fallbackIcon: "🏛️"
            },
            {
                id: 19,
                name: "Villa Fête Rivière-Pilote",
                location: "Rivière-Pilote, Martinique",
                price: 180,
                guests: 20,
                guestsDetail: "Jusqu'à 20 personnes",
                features: "Villa créole, piscine tropicale",
                category: "fete",
                image: "./images/Villa_Fete_Journee_R_Pilote/03_villa_creole_piscine_terrasse.jpg",
                gallery: [
                    "./images/Villa_Fete_Journee_R_Pilote/03_villa_creole_piscine_terrasse.jpg",
                    "./images/Villa_Fete_Journee_R_Pilote/04_piscine_tropicale_vue_panoramique.jpg",
                    "./images/Villa_Fete_Journee_R_Pilote/01_salle_a_manger_interieur.jpg",
                    "./images/Villa_Fete_Journee_R_Pilote/05_cuisine_moderne_equipee.jpg",
                    "./images/Villa_Fete_Journee_R_Pilote/06_terrasse_pierre_piscine.jpg"
                ],
                fallbackIcon: "🌴"
            },
            {
                id: 20,
                name: "Villa Fête Sainte-Luce",
                location: "Sainte-Luce, Martinique",
                price: 220,
                guests: 35,
                guestsDetail: "Jusqu'à 35 personnes",
                features: "Villa moderne, tentes, mobilier événementiel",
                category: "fete",
                image: "./images/Villa_Fete_Journee_Sainte_Luce/01_villa_moderne_piscine_terrasse.jpg",
                gallery: [
                    "./images/Villa_Fete_Journee_Sainte_Luce/01_villa_moderne_piscine_terrasse.jpg",
                    "./images/Villa_Fete_Journee_Sainte_Luce/02_piscine_tentes_amenagement.jpg",
                    "./images/Villa_Fete_Journee_Sainte_Luce/03_tentes_blanches_mobilier.jpg",
                    "./images/Villa_Fete_Journee_Sainte_Luce/04_villa_contemporaine_exterieur.jpg",
                    "./images/Villa_Fete_Journee_Sainte_Luce/05_decoration_anniversaire_fete.jpg"
                ],
                fallbackIcon: "🎪"
            },
            {
                id: 21,
                name: "Villa Fête Rivière-Salée",
                location: "Rivière-Salée, Martinique",
                price: 160,
                guests: 15,
                guestsDetail: "Jusqu'à 15 personnes",
                features: "Piscine, tente couverte",
                category: "fete",
                image: "./images/Villa_Fete_Journee_Riviere_Salee/01_piscine_tente_couverte.jpg",
                gallery: [
                    "./images/Villa_Fete_Journee_Riviere_Salee/01_piscine_tente_couverte.jpg"
                ],
                fallbackIcon: "⛺"
            }
        ];

        let filteredVillas = [...villasData];
        let currentVilla = null;
        let currentGalleryIndex = 0;
        let currentGallery = [];

        // Initialisation des calendriers
        let checkinCalendar, checkoutCalendar, modalCheckinCalendar, modalCheckoutCalendar;

        document.addEventListener('DOMContentLoaded', function() {
            console.log("🚀 DOM Content Loaded - Initialisation...");
            
            // CORRECTION 1 : S'assurer que toutes les villas s'affichent au chargement
            filteredVillas = [...villasData];
            console.log(`📊 Villas chargées: ${villasData.length}, filtrées: ${filteredVillas.length}`);
            
            // Afficher les villas IMMÉDIATEMENT
            displayVillas();
            
            // CORRECTION 2 : Initialisation des calendriers avec vérification complète
            setTimeout(function() {
                console.log("📅 Initialisation des calendriers...");
                
                // Vérifier que Flatpickr est disponible
                if (typeof flatpickr === 'undefined') {
                    console.error("❌ Flatpickr n'est pas chargé !");
                    return;
                }
                
                // Vérifier que les éléments existent
                const checkinElement = document.getElementById('checkin');
                const checkoutElement = document.getElementById('checkout');
                
                if (!checkinElement || !checkoutElement) {
                    console.error("❌ Éléments calendrier non trouvés !");
                    return;
                }
                
                console.log("✅ Flatpickr disponible, éléments trouvés");
                
                // Initialiser les calendriers
                const today = new Date();
                const tomorrow = new Date(today);
                tomorrow.setDate(tomorrow.getDate() + 1);
                
                try {
                    // Calendrier arrivée
                    checkinCalendar = flatpickr(checkinElement, {
                        locale: "fr",
                        minDate: today,
                        dateFormat: "d/m/Y",
                        allowInput: true,
                        clickOpens: true,
                        disableMobile: false,
                        onChange: function(selectedDates) {
                            console.log("📅 Date arrivée sélectionnée:", selectedDates[0]);
                            if (selectedDates[0] && checkoutCalendar) {
                                const nextDay = new Date(selectedDates[0]);
                                nextDay.setDate(nextDay.getDate() + 1);
                                checkoutCalendar.set('minDate', nextDay);
                            }
                        }
                    });
                    
                    // Calendrier départ
                    checkoutCalendar = flatpickr(checkoutElement, {
                        locale: "fr",
                        minDate: tomorrow,
                        dateFormat: "d/m/Y",
                        allowInput: true,
                        clickOpens: true,
                        disableMobile: false,
                        onChange: function(selectedDates) {
                            console.log("📅 Date départ sélectionnée:", selectedDates[0]);
                        }
                    });
                    
                    console.log("✅ Calendriers initialisés avec succès !");
                    
                    // Test d'ouverture forcée au clic
                    checkinElement.addEventListener('click', function(e) {
                        console.log("🖱️ Clic sur arrivée");
                        e.preventDefault();
                        if (checkinCalendar) {
                            checkinCalendar.open();
                        }
                    });
                    
                    checkoutElement.addEventListener('click', function(e) {
                        console.log("🖱️ Clic sur départ");
                        e.preventDefault();
                        if (checkoutCalendar) {
                            checkoutCalendar.open();
                        }
                    });
                    
                } catch (error) {
                    console.error("❌ Erreur initialisation calendriers:", error);
                }
                
            }, 500); // Délai plus long pour être sûr

            // Forcer l'ouverture des calendriers au clic
            document.getElementById('checkin').addEventListener('click', function() {
                if (checkinCalendar) {
                    checkinCalendar.open();
                }
            });

            document.getElementById('checkout').addEventListener('click', function() {
                if (checkoutCalendar) {
                    checkoutCalendar.open();
                }
            });

            // Calendriers de la modale
            modalCheckinCalendar = flatpickr("#modalCheckin", {
                locale: "fr",
                minDate: today,
                dateFormat: "d/m/Y",
                placeholder: "Date d'arrivée",
                onChange: function(selectedDates) {
                    if (selectedDates[0]) {
                        const nextDay = new Date(selectedDates[0]);
                        nextDay.setDate(nextDay.getDate() + 1);
                        modalCheckoutCalendar.set('minDate', nextDay);
                        calculatePrice();
                    }
                }
            });

            modalCheckoutCalendar = flatpickr("#modalCheckout", {
                locale: "fr",
                minDate: tomorrow,
                dateFormat: "d/m/Y",
                placeholder: "Date de départ",
                onChange: function() {
                    calculatePrice();
                }
            });

            // S'assurer que les villas s'affichent au chargement
            console.log(`📊 Nombre de villas chargées: ${villasData.length}`);
            console.log(`📊 Nombre de villas filtrées: ${filteredVillas.length}`);
            
            // Message de bienvenue
            showStatusMessage(`✅ Bienvenue sur KhanelConcept ! ${villasData.length} villas de luxe chargées automatiquement.`, 'success');
        });

        // Fonctions de gestion des sections
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.classList.remove('active');
            });
            
            document.getElementById(sectionId).classList.add('active');
            document.getElementById('nav-' + sectionId).classList.add('active');
        }

        // Fonctions de filtrage
        function filterVillas(category) {
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            if (category === 'all') {
                filteredVillas = [...villasData];
            } else if (category === 'pmr') {
                filteredVillas = villasData.filter(villa => 
                    villa.features.toLowerCase().includes('accessible') || 
                    villa.location.toLowerCase().includes('ste-luce') ||
                    villa.guests <= 4
                );
            } else {
                filteredVillas = villasData.filter(villa => villa.category === category);
            }
            
            displayVillas();
        }

        // ===== FONCTIONS BARRE DE RECHERCHE INTELLIGENTE =====
        
        // Liste des communes de Martinique pour l'autocomplete
        const communesMartinique = [
            'Sainte-Anne', 'Vauclin', 'Lamentin', 'Macabou', 'Petit Macabou', 'Sainte-Luce', 
            'Trinité', 'Le Robert', 'Rivière-Pilote', 'Ducos', 'Fort-de-France', 
            'Trenelle', 'Le Marin', 'Rivière-Salée', 'Les Trois-Îlets', 
            'Le Diamant', 'Les Anses-d\'Arlet', 'Le Carbet', 'Bellefontaine',
            'Case-Pilote', 'Schoelcher', 'Saint-Joseph', 'Le Lorrain',
            'Marigot', 'Sainte-Marie', 'Le Prêcheur', 'Grand\'Rivière',
            'L\'Ajoupa-Bouillon', 'Basse-Pointe', 'Macouba', 'Le Morne-Rouge',
            'Saint-Pierre', 'Le Morne-Vert', 'Fonds-Saint-Denis'
        ];

        // État des voyageurs
        let voyageursCount = {
            adultes: 2,
            enfants: 0,
            bebes: 0
        };

        let showLocationSuggestionsFlag = false;
        let showVoyageursDropdownFlag = false;

        // Fonction pour gérer l'input de localisation
        function handleLocationInput(value) {
            const suggestionsDiv = document.getElementById('suggestions-dropdown');
            
            if (value.length > 0) {
                const filtered = communesMartinique.filter(commune =>
                    commune.toLowerCase().includes(value.toLowerCase())
                );
                
                if (filtered.length > 0) {
                    suggestionsDiv.innerHTML = filtered.slice(0, 5).map(commune => 
                        `<div class="suggestion-item" onclick="selectLocation('${commune}')">📍 ${commune}</div>`
                    ).join('');
                    suggestionsDiv.style.display = 'block';
                } else {
                    suggestionsDiv.style.display = 'none';
                }
            } else {
                suggestionsDiv.style.display = 'none';
            }
        }

        // Fonction pour sélectionner une localisation
        function selectLocation(commune) {
            document.getElementById('location-search').value = commune;
            document.getElementById('suggestions-dropdown').style.display = 'none';
        }

        // Fonction pour montrer/cacher les suggestions
        function showLocationSuggestions(show) {
            showLocationSuggestionsFlag = show;
        }

        // Fonction pour toggle le dropdown voyageurs
        function toggleVoyageursDropdown() {
            const menu = document.getElementById('voyageurs-menu');
            const trigger = document.querySelector('.voyageurs-display');
            
            showVoyageursDropdownFlag = !showVoyageursDropdownFlag;
            
            if (showVoyageursDropdownFlag) {
                // Positionner le dropdown près du trigger
                const rect = trigger.getBoundingClientRect();
                menu.style.top = (rect.bottom + 10) + 'px';
                menu.style.left = (rect.left) + 'px';
                menu.style.transform = 'none';
                menu.classList.add('active');
            } else {
                menu.classList.remove('active');
            }
        }

        // Fonction pour mettre à jour le nombre de voyageurs
        function updateVoyageurs(type, increment) {
            if (type === 'adultes' && voyageursCount.adultes + increment < 1) return;
            if (voyageursCount[type] + increment < 0) return;
            
            voyageursCount[type] += increment;
            
            // Mettre à jour l'affichage
            document.getElementById(type + '-count').textContent = voyageursCount[type];
            updateVoyageursDisplay();
            
            // Désactiver/activer les boutons
            updateCounterButtons();
        }

        // Fonction pour afficher le texte des voyageurs
        function updateVoyageursDisplay() {
            let display = `${voyageursCount.adultes} adulte${voyageursCount.adultes > 1 ? 's' : ''}`;
            if (voyageursCount.enfants > 0) {
                display += `, ${voyageursCount.enfants} enfant${voyageursCount.enfants > 1 ? 's' : ''}`;
            }
            if (voyageursCount.bebes > 0) {
                display += `, ${voyageursCount.bebes} bébé${voyageursCount.bebes > 1 ? 's' : ''}`;
            }
            
            document.querySelector('.voyageurs-display').value = display;
        }

        // Fonction pour mettre à jour l'état des boutons
        function updateCounterButtons() {
            // Bouton minus adultes
            const adultesMinusBtn = document.querySelector('button[onclick="updateVoyageurs(\'adultes\', -1)"]');
            if (adultesMinusBtn) {
                adultesMinusBtn.disabled = voyageursCount.adultes <= 1;
            }
            
            // Boutons minus enfants et bébés
            const enfantsMinusBtn = document.querySelector('button[onclick="updateVoyageurs(\'enfants\', -1)"]');
            if (enfantsMinusBtn) {
                enfantsMinusBtn.disabled = voyageursCount.enfants <= 0;
            }
            
            const bebesMinusBtn = document.querySelector('button[onclick="updateVoyageurs(\'bebes\', -1)"]');
            if (bebesMinusBtn) {
                bebesMinusBtn.disabled = voyageursCount.bebes <= 0;
            }
        }

        // Gestion des clics en dehors des dropdowns
        document.addEventListener('click', function(event) {
            // Fermer suggestions localisation
            if (!event.target.closest('.location-field')) {
                document.getElementById('suggestions-dropdown').style.display = 'none';
            }
            
            // Fermer dropdown voyageurs
            if (!event.target.closest('.guests-field')) {
                document.getElementById('voyageurs-menu').classList.remove('active');
                showVoyageursDropdownFlag = false;
            }
        });

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            updateCounterButtons();
        });

        // ===== FIN FONCTIONS BARRE DE RECHERCHE INTELLIGENTE =====

        // Fonction de recherche
        function performSearch() {
            const destination = document.getElementById('destination').value.toLowerCase();
            const guests = parseInt(document.getElementById('guests').value) || 0;

            showStatusMessage('Recherche en cours...', 'loading');

            setTimeout(() => {
                let results = [...villasData];

                if (destination) {
                    results = results.filter(villa => 
                        villa.location.toLowerCase().includes(destination) ||
                        villa.name.toLowerCase().includes(destination)
                    );
                }

                if (guests > 0) {
                    results = results.filter(villa => villa.guests >= guests);
                }

                filteredVillas = results;
                displayVillas();
                
                if (results.length === 0) {
                    showStatusMessage('Aucune villa trouvée pour ces critères. Essayez avec d\'autres paramètres.', 'error');
                } else {
                    showStatusMessage(`${results.length} villa(s) trouvée(s) !`, 'success');
                }
            }, 1000);
        }

        // Affichage des villas
        function displayVillas() {
            const grid = document.getElementById('villasGrid');
            
            if (filteredVillas.length === 0) {
                grid.innerHTML = '<div class="glass-card"><h3>Aucune villa trouvée</h3><p>Essayez de modifier vos critères de recherche.</p></div>';
                return;
            }

            grid.innerHTML = filteredVillas.map(villa => {
                const priceUnit = villa.priceUnit || '€/nuit';
                return `
                    <div class="villa-card">
                        <div class="villa-image-container" style="height: 200px; overflow: hidden;">
                            <img 
                                src="${villa.image}" 
                                alt="${villa.name}"
                                class="villa-image"
                                onclick="openImageGallery(${villa.id}, 0)"
                                onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
                                onload="this.nextElementSibling.style.display='none';"
                            >
                            <div class="image-placeholder" style="display: none;" onclick="openImageGallery(${villa.id}, 0)">
                                ${villa.fallbackIcon}
                            </div>
                        </div>
                        <div class="villa-content">
                            <h3>${villa.name}</h3>
                            <p><i class="fas fa-map-marker-alt"></i> ${villa.location}</p>
                            <p><i class="fas fa-users"></i> ${villa.guestsDetail}</p>
                            <p><i class="fas fa-swimming-pool"></i> ${villa.features}</p>
                            <div class="price">${villa.price} ${priceUnit}</div>
                            <div class="villa-buttons">
                                <button class="btn-primary" onclick="openReservationModal(${villa.id})">Réserver</button>
                                <button class="btn-secondary" onclick="viewDetails(${villa.id})">Détails</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Modale de réservation
        function openReservationModal(villaId) {
            currentVilla = villasData.find(v => v.id === villaId);
            document.getElementById('modalVillaName').textContent = `Réservation - ${currentVilla.name}`;
            document.getElementById('reservationModal').classList.add('active');
            
            // Pré-remplir les dates si déjà sélectionnées
            const checkinValue = document.getElementById('checkin').value;
            const checkoutValue = document.getElementById('checkout').value;
            const guestsValue = document.getElementById('guests').value;
            
            if (checkinValue) modalCheckinCalendar.setDate(checkinValue);
            if (checkoutValue) modalCheckoutCalendar.setDate(checkoutValue);
            if (guestsValue) document.getElementById('modalGuests').value = guestsValue;
            
            calculatePrice();
        }

        function closeReservationModal() {
            document.getElementById('reservationModal').classList.remove('active');
            document.getElementById('reservationForm').reset();
            document.getElementById('priceCalculation').style.display = 'none';
        }

        function calculatePrice() {
            if (!currentVilla) return;
            
            const checkinDate = modalCheckinCalendar.selectedDates[0];
            const checkoutDate = modalCheckoutCalendar.selectedDates[0];
            
            if (checkinDate && checkoutDate && checkinDate < checkoutDate) {
                const nights = Math.ceil((checkoutDate - checkinDate) / (1000 * 60 * 60 * 24));
                const totalPrice = nights * currentVilla.price;
                
                document.getElementById('summaryVillaName').textContent = currentVilla.name;
                document.getElementById('summaryDates').textContent = 
                    `${checkinDate.toLocaleDateString('fr-FR')} - ${checkoutDate.toLocaleDateString('fr-FR')}`;
                document.getElementById('summaryNights').textContent = `${nights} nuit${nights > 1 ? 's' : ''}`;
                document.getElementById('summaryPricePerNight').textContent = `${currentVilla.price}€`;
                document.getElementById('summaryTotal').textContent = `${totalPrice}€`;
                
                document.getElementById('priceCalculation').style.display = 'block';
            } else {
                document.getElementById('priceCalculation').style.display = 'none';
            }
        }

        // Galerie d'images
        function openImageGallery(villaId, imageIndex = 0) {
            const villa = villasData.find(v => v.id === villaId);
            if (!villa || !villa.gallery) return;
            
            currentGallery = villa.gallery;
            currentGalleryIndex = imageIndex;
            
            updateGalleryImage();
            updateThumbnails();
            
            document.getElementById('imageGalleryModal').classList.add('active');
        }

        function closeImageGallery() {
            document.getElementById('imageGalleryModal').classList.remove('active');
        }

        function previousImage() {
            currentGalleryIndex = (currentGalleryIndex - 1 + currentGallery.length) % currentGallery.length;
            updateGalleryImage();
            updateThumbnails();
        }

        function nextImage() {
            currentGalleryIndex = (currentGalleryIndex + 1) % currentGallery.length;
            updateGalleryImage();
            updateThumbnails();
        }

        function goToImage(index) {
            currentGalleryIndex = index;
            updateGalleryImage();
            updateThumbnails();
        }

        function updateGalleryImage() {
            document.getElementById('galleryImage').src = currentGallery[currentGalleryIndex];
        }

        function updateThumbnails() {
            const thumbnailsContainer = document.getElementById('galleryThumbnails');
            thumbnailsContainer.innerHTML = currentGallery.map((image, index) => 
                `<img src="${image}" class="thumbnail ${index === currentGalleryIndex ? 'active' : ''}" onclick="goToImage(${index})">`
            ).join('');
        }

        // Fonctions d'actions
        function viewDetails(villaId) {
            // Store villa ID for villa-details page
            localStorage.setItem('selectedVillaId', villaId);
            
            // Navigate to villa details page
            window.location.href = `villa-details.html?id=${villaId}`;
        }

        function contactPrestataire(service) {
            showStatusMessage(`Redirection vers ${service}...`, 'loading');
            
            setTimeout(() => {
                alert(`Service ${service}\n\nContactez-nous pour plus d'informations :\n📞 +596 696 XX XX XX\n📧 contact@khanelconcept.com`);
                showStatusMessage(`Contact ${service} - Formulaire affiché`, 'success');
            }, 1000);
        }

        function showComingSoon() {
            showStatusMessage('Fonctionnalité en cours de développement...', 'loading');
            
            setTimeout(() => {
                alert('Cette fonctionnalité sera bientôt disponible !\n\nRestez connecté pour les nouveautés.');
                showStatusMessage('Fonctionnalité à venir - Notification envoyée', 'success');
            }, 1000);
        }

        // Messages de statut
        function showStatusMessage(message, type) {
            const statusEl = document.getElementById('status-message');
            statusEl.textContent = message;
            statusEl.className = 'status-message ' + type;
            statusEl.style.display = 'block';
            
            if (type !== 'loading') {
                setTimeout(() => {
                    statusEl.style.display = 'none';
                }, 3000);
            }
        }

        // Gestion du formulaire de réservation
        document.getElementById('reservationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = {
                villa: currentVilla.name,
                villaId: currentVilla.id,
                customerName: document.getElementById('customerName').value,
                customerEmail: document.getElementById('customerEmail').value,
                customerPhone: document.getElementById('customerPhone').value,
                checkin: modalCheckinCalendar.selectedDates[0]?.toLocaleDateString('fr-FR'),
                checkout: modalCheckoutCalendar.selectedDates[0]?.toLocaleDateString('fr-FR'),
                guests: document.getElementById('modalGuests').value,
                message: document.getElementById('customerMessage').value,
                total: document.getElementById('summaryTotal')?.textContent || 'N/A'
            };
            
            showStatusMessage('Traitement de votre réservation...', 'loading');
            
            // Simuler l'envoi de la réservation
            setTimeout(() => {
                showStatusMessage('Réservation confirmée ! Un email de confirmation va vous être envoyé.', 'success');
                
                // Afficher un résumé détaillé
                alert(`✅ Réservation confirmée !\n\n🏖️ Villa: ${formData.villa}\n👤 Client: ${formData.customerName}\n📧 Email: ${formData.customerEmail}\n📞 Téléphone: ${formData.customerPhone}\n📅 Du ${formData.checkin} au ${formData.checkout}\n👥 ${formData.guests} voyageurs\n💰 Total: ${formData.total}\n\n📧 Un email de confirmation va vous être envoyé avec tous les détails.\n📞 Notre équipe vous contactera dans les plus brefs délais.`);
                
                closeReservationModal();
            }, 2000);
        });

        // Gestion des événements clavier pour la galerie
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('imageGalleryModal').classList.contains('active')) {
                if (e.key === 'ArrowLeft') previousImage();
                if (e.key === 'ArrowRight') nextImage();
                if (e.key === 'Escape') closeImageGallery();
            }
            
            if (document.getElementById('reservationModal').classList.contains('active')) {
                if (e.key === 'Escape') closeReservationModal();
            }
        });

        // Fermer les modales en cliquant à l'extérieur
        window.onclick = function(event) {
            const reservationModal = document.getElementById('reservationModal');
            const galleryModal = document.getElementById('imageGalleryModal');
            
            if (event.target === reservationModal) {
                closeReservationModal();
            }
            
            if (event.target === galleryModal) {
                closeImageGallery();
            }
        }
    </script>
</body>
</html>