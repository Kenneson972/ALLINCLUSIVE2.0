<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Programme Fidélité - KhanelConcept Espace Membre</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Découvrez votre programme fidélité KhanelConcept - Points, niveaux, récompenses et avantages exclusifs pour les membres.">
    <meta name="keywords" content="programme fidélité KhanelConcept, points, récompenses, niveaux membres, avantages exclusifs">
    <meta name="author" content="KhanelConcept">
    
    <!-- CSS Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/chart.js@4.2.1/dist/chart.min.css" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary-gradient: linear-gradient(135deg, #87ceeb 0%, #4682b4 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            --warning-gradient: linear-gradient(135deg, #ffa726 0%, #fb8c00 100%);
            --discoverer-gradient: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
            --explorer-gradient: linear-gradient(135deg, #3182ce 0%, #2b77cb 100%);
            --adventurer-gradient: linear-gradient(135deg, #38a169 0%, #2f855a 100%);
            --legend-gradient: linear-gradient(135deg, #d69e2e 0%, #b7791f 100%);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --text-primary: #2d3748;
            --text-secondary: #718096;
            --accent-gold: #f6ad55;
            --shadow-soft: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #87ceeb 0%, #4682b4 100%);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            line-height: 1.6;
            color: var(--text-primary);
        }
        
        /* Video Background */
        .video-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            overflow: hidden;
        }
        
        .video-background video {
            position: absolute;
            top: 50%;
            left: 50%;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            transform: translate(-50%, -50%);
            object-fit: cover;
            filter: brightness(0.7) contrast(1.1) saturate(1.2);
        }
        
        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            z-index: -1;
        }
        
        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: sticky;
            top: 0;
            z-index: 50;
            transition: all 0.3s ease;
        }
        
        .logo {
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .logo i {
            color: #FFA500;
        }
        
        /* Container */
        .loyalty-container {
            padding: 2rem;
            min-height: calc(100vh - 80px);
        }
        
        .loyalty-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }
        
        /* Header Section */
        .loyalty-header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 3rem;
            text-align: center;
        }
        
        .loyalty-title {
            color: white;
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }
        
        .loyalty-subtitle {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.3rem;
            margin-bottom: 2rem;
        }
        
        .current-level-badge {
            display: inline-block;
            padding: 12px 30px;
            border-radius: 30px;
            font-size: 1.2rem;
            font-weight: 700;
            color: white;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }
        
        .current-level-badge.discoverer { background: var(--discoverer-gradient); }
        .current-level-badge.explorer { background: var(--explorer-gradient); }
        .current-level-badge.adventurer { background: var(--adventurer-gradient); }
        .current-level-badge.legend { background: var(--legend-gradient); }
        
        .current-level-badge::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 3s infinite;
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        /* Stats Grid */
        .loyalty-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-soft);
        }
        
        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 1.5rem;
            color: white;
        }
        
        .stat-icon.points { background: var(--warning-gradient); }
        .stat-icon.earned { background: var(--success-gradient); }
        .stat-icon.spent { background: var(--secondary-gradient); }
        .stat-icon.level { background: var(--primary-gradient); }
        
        .stat-value {
            color: white;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        /* Level Progress Section */
        .level-progress-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 2.5rem;
        }
        
        .section-title {
            color: white;
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .level-progress-bar {
            position: relative;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 1rem;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 1s ease-in-out;
            position: relative;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: progress-shimmer 2s infinite;
        }
        
        @keyframes progress-shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(200%); }
        }
        
        .progress-info {
            display: flex;
            justify-content: space-between;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.95rem;
            margin-bottom: 1rem;
        }
        
        .next-level-benefits {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .next-level-title {
            color: var(--accent-gold);
            font-weight: 600;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }
        
        .benefits-list {
            list-style: none;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 0.5rem;
        }
        
        .benefit-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
        }
        
        .benefit-icon {
            color: var(--accent-gold);
        }
        
        /* Levels Overview */
        .levels-overview {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 2.5rem;
        }
        
        .levels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .level-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 2rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .level-card.current {
            border-color: var(--accent-gold);
            transform: scale(1.05);
            box-shadow: 0 20px 40px rgba(246, 173, 85, 0.3);
        }
        
        .level-card.achieved {
            border-color: #38a169;
        }
        
        .level-card:hover {
            transform: translateY(-5px);
        }
        
        .level-card.current:hover {
            transform: scale(1.05) translateY(-5px);
        }
        
        .level-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .level-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }
        
        .level-icon.discoverer { background: var(--discoverer-gradient); }
        .level-icon.explorer { background: var(--explorer-gradient); }
        .level-icon.adventurer { background: var(--adventurer-gradient); }
        .level-icon.legend { background: var(--legend-gradient); }
        
        .level-info h3 {
            color: white;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }
        
        .level-range {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }
        
        .level-benefits {
            list-style: none;
        }
        
        .level-benefits li {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 0.75rem;
            font-size: 0.9rem;
        }
        
        .level-benefits i {
            color: var(--accent-gold);
            width: 16px;
            text-align: center;
        }
        
        .level-status {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .level-status.current {
            background: var(--accent-gold);
            color: white;
        }
        
        .level-status.achieved {
            background: rgba(56, 161, 105, 0.2);
            color: #68d391;
        }
        
        .level-status.upcoming {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.6);
        }
        
        /* Rewards Section */
        .rewards-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 2.5rem;
        }
        
        .rewards-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .reward-tab {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.8);
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .reward-tab.active {
            background: var(--accent-gold);
            border-color: var(--accent-gold);
            color: white;
        }
        
        .rewards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }
        
        .reward-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .reward-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-soft);
        }
        
        .reward-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .reward-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: white;
            background: var(--accent-gold);
        }
        
        .reward-title {
            color: white;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .reward-cost {
            color: var(--accent-gold);
            font-weight: 700;
            font-size: 1rem;
            margin-left: auto;
        }
        
        .reward-description {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            margin-bottom: 1rem;
            line-height: 1.5;
        }
        
        .reward-button {
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .reward-button:hover {
            transform: translateY(-2px);
        }
        
        .reward-button:disabled {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.5);
            cursor: not-allowed;
            transform: none;
        }
        
        /* Transaction History */
        .transactions-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 2.5rem;
        }
        
        .transactions-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .transaction-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            border-left: 4px solid transparent;
        }
        
        .transaction-item.earn { border-left-color: #38a169; }
        .transaction-item.spend { border-left-color: #e53e3e; }
        .transaction-item.bonus { border-left-color: #d69e2e; }
        
        .transaction-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            color: white;
        }
        
        .transaction-icon.earn { background: var(--success-gradient); }
        .transaction-icon.spend { background: var(--secondary-gradient); }
        .transaction-icon.bonus { background: var(--warning-gradient); }
        
        .transaction-content {
            flex: 1;
        }
        
        .transaction-title {
            color: white;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .transaction-desc {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }
        
        .transaction-amount {
            font-weight: 700;
            font-size: 1.1rem;
        }
        
        .transaction-amount.earn { color: #68d391; }
        .transaction-amount.spend { color: #fc8181; }
        .transaction-amount.bonus { color: #f6ad55; }
        
        .transaction-time {
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.8rem;
        }
        
        /* Loading States */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            color: white;
        }
        
        .loading-spinner {
            width: 24px;
            height: 24px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 0.5rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Responsive Design */
        @media (max-width: 1024px) {
            .levels-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .loyalty-container {
                padding: 1rem;
            }
            
            .loyalty-header,
            .level-progress-section,
            .levels-overview,
            .rewards-section,
            .transactions-section {
                padding: 2rem 1.5rem;
                border-radius: 20px;
            }
            
            .loyalty-title {
                font-size: 2rem;
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .loyalty-stats {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }
            
            .levels-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .level-card.current {
                transform: none;
            }
            
            .rewards-tabs {
                flex-wrap: wrap;
                gap: 0.5rem;
            }
            
            .reward-tab {
                padding: 10px 18px;
                font-size: 0.9rem;
            }
            
            .rewards-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }
    </style>
  <script src="assets/js/storage-guard.js"></script>
</head>

<body>
    <!-- Background Video -->
    <div class="video-background">
        <video id="backgroundVideo" autoplay muted loop playsinline preload="metadata" webkit-playsinline>
            <source src="https://res.cloudinary.com/ddulasmtz/video/upload/v1752950782/background-video.mp4_qoofsz.mp4" type="video/mp4">
            Votre navigateur ne supporte pas la lecture de vidéos HTML5.
        </video>
        <div class="video-overlay"></div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <a href="index.html" class="logo">
                    <i class="fas fa-palm-tree"></i>
                    KhanelConcept
                </a>
                
                <div class="hidden md:flex items-center gap-4">
                    <a href="dashboard.html" class="text-white/80 hover:text-white transition-colors">Dashboard</a>
                    <a href="profile.html" class="text-white/80 hover:text-white transition-colors">Profil</a>
                    <a href="index.html" class="text-white/80 hover:text-white transition-colors">Villas</a>
                    <button onclick="logout()" class="text-white/80 hover:text-white transition-colors">Déconnexion</button>
                </div>
            </div>
        </div>
    </header>

    <!-- Loyalty Container -->
    <div class="loyalty-container">
        <div class="loyalty-content">
            
            <!-- Header Section -->
            <section class="loyalty-header" data-aos="fade-up">
                <h1 class="loyalty-title">
                    <i class="fas fa-star"></i>
                    Programme Fidélité KhanelConcept
                </h1>
                <p class="loyalty-subtitle">
                    Chaque séjour vous rapproche de récompenses exclusives et d'expériences inoubliables
                </p>
                <div class="current-level-badge discoverer" id="currentLevelBadge">
                    🌟 Niveau Découvreur
                </div>
                
                <!-- Stats Grid -->
                <div class="loyalty-stats">
                    <div class="stat-card" data-aos="fade-up" data-aos-delay="100">
                        <div class="stat-icon points">
                            <i class="fas fa-coins"></i>
                        </div>
                        <div class="stat-value" id="currentPoints">100</div>
                        <div class="stat-label">Points Actuels</div>
                    </div>
                    <div class="stat-card" data-aos="fade-up" data-aos-delay="200">
                        <div class="stat-icon earned">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                        <div class="stat-value" id="totalEarned">100</div>
                        <div class="stat-label">Points Gagnés</div>
                    </div>
                    <div class="stat-card" data-aos="fade-up" data-aos-delay="300">
                        <div class="stat-icon spent">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <div class="stat-value" id="totalSpent">0</div>
                        <div class="stat-label">Points Utilisés</div>
                    </div>
                    <div class="stat-card" data-aos="fade-up" data-aos-delay="400">
                        <div class="stat-icon level">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="stat-value" id="levelPosition">1/4</div>
                        <div class="stat-label">Niveau Actuel</div>
                    </div>
                </div>
            </section>

            <!-- Level Progress Section -->
            <section class="level-progress-section" data-aos="fade-up">
                <h2 class="section-title">
                    <i class="fas fa-chart-line"></i>
                    Progression vers le niveau suivant
                </h2>
                
                <div class="level-progress-bar">
                    <div class="progress-fill" id="progressBar" style="width: 20%; background: var(--explorer-gradient);"></div>
                </div>
                
                <div class="progress-info">
                    <span>Niveau actuel: <strong id="currentLevelName">Découvreur</strong></span>
                    <span id="progressText">100 / 500 points</span>
                </div>
                
                <div class="next-level-benefits" id="nextLevelBenefits">
                    <div class="next-level-title">
                        🎯 Avantages du niveau Explorateur (500 points)
                    </div>
                    <ul class="benefits-list">
                        <li class="benefit-item">
                            <i class="benefit-icon fas fa-clock"></i>
                            <span>Check-in prioritaire dès 14h</span>
                        </li>
                        <li class="benefit-item">
                            <i class="benefit-icon fas fa-wifi"></i>
                            <span>WiFi premium haute vitesse</span>
                        </li>
                        <li class="benefit-item">
                            <i class="benefit-icon fas fa-clock"></i>
                            <span>Late checkout jusqu'à 13h</span>
                        </li>
                        <li class="benefit-item">
                            <i class="benefit-icon fas fa-gift"></i>
                            <span>Welcome drink offert</span>
                        </li>
                    </ul>
                </div>
            </section>

            <!-- Levels Overview -->
            <section class="levels-overview" data-aos="fade-up">
                <h2 class="section-title">
                    <i class="fas fa-layer-group"></i>
                    Les 4 Niveaux du Programme
                </h2>
                
                <div class="levels-grid">
                    <div class="level-card current" data-aos="zoom-in" data-aos-delay="100">
                        <div class="level-status current">Actuel</div>
                        <div class="level-header">
                            <div class="level-icon discoverer">🌟</div>
                            <div class="level-info">
                                <h3>Découvreur</h3>
                                <div class="level-range">0 - 499 points</div>
                            </div>
                        </div>
                        <ul class="level-benefits">
                            <li><i class="fas fa-check"></i> Support client standard</li>
                            <li><i class="fas fa-check"></i> Accès aux réservations</li>
                            <li><i class="fas fa-check"></i> Newsletters et actualités</li>
                            <li><i class="fas fa-check"></i> Programme de parrainage</li>
                        </ul>
                    </div>

                    <div class="level-card" data-aos="zoom-in" data-aos-delay="200">
                        <div class="level-status upcoming">À débloquer</div>
                        <div class="level-header">
                            <div class="level-icon explorer">🗺️</div>
                            <div class="level-info">
                                <h3>Explorateur</h3>
                                <div class="level-range">500 - 1,499 points</div>
                            </div>
                        </div>
                        <ul class="level-benefits">
                            <li><i class="fas fa-star"></i> Tous les avantages Découvreur</li>
                            <li><i class="fas fa-star"></i> Check-in prioritaire (14h)</li>
                            <li><i class="fas fa-star"></i> Late checkout (13h)</li>
                            <li><i class="fas fa-star"></i> WiFi premium gratuit</li>
                            <li><i class="fas fa-star"></i> Welcome drink offert</li>
                        </ul>
                    </div>

                    <div class="level-card" data-aos="zoom-in" data-aos-delay="300">
                        <div class="level-status upcoming">À débloquer</div>
                        <div class="level-header">
                            <div class="level-icon adventurer">⚔️</div>
                            <div class="level-info">
                                <h3>Aventurier</h3>
                                <div class="level-range">1,500 - 2,999 points</div>
                            </div>
                        </div>
                        <ul class="level-benefits">
                            <li><i class="fas fa-gem"></i> Tous les avantages Explorateur</li>
                            <li><i class="fas fa-gem"></i> Surclassement gratuit (si disponible)</li>
                            <li><i class="fas fa-gem"></i> Minibar offert</li>
                            <li><i class="fas fa-gem"></i> Room service 24/7</li>
                            <li><i class="fas fa-gem"></i> Réservations prioritaires</li>
                        </ul>
                    </div>

                    <div class="level-card" data-aos="zoom-in" data-aos-delay="400">
                        <div class="level-status upcoming">À débloquer</div>
                        <div class="level-header">
                            <div class="level-icon legend">👑</div>
                            <div class="level-info">
                                <h3>Légende</h3>
                                <div class="level-range">3,000+ points</div>
                            </div>
                        </div>
                        <ul class="level-benefits">
                            <li><i class="fas fa-crown"></i> Tous les avantages Aventurier</li>
                            <li><i class="fas fa-crown"></i> Conciergerie 24/7 dédiée</li>
                            <li><i class="fas fa-crown"></i> Transferts VIP inclus</li>
                            <li><i class="fas fa-crown"></i> Expériences privées exclusives</li>
                            <li><i class="fas fa-crown"></i> Chef privé sur demande</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Rewards Section -->
            <section class="rewards-section" data-aos="fade-up">
                <h2 class="section-title">
                    <i class="fas fa-gift"></i>
                    Boutique de Récompenses
                </h2>
                
                <div class="rewards-tabs">
                    <div class="reward-tab active" onclick="showRewardTab('nights')">Nuits Gratuites</div>
                    <div class="reward-tab" onclick="showRewardTab('services')">Services</div>
                    <div class="reward-tab" onclick="showRewardTab('experiences')">Expériences</div>
                    <div class="reward-tab" onclick="showRewardTab('merchandise')">Goodies</div>
                </div>

                <div class="rewards-grid" id="rewardsContent">
                    <!-- Rewards will be loaded dynamically -->
                </div>
            </section>

            <!-- Transaction History -->
            <section class="transactions-section" data-aos="fade-up">
                <h2 class="section-title">
                    <i class="fas fa-history"></i>
                    Historique des Points
                </h2>
                
                <div class="transactions-list" id="transactionsList">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        Chargement de votre historique...
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
        // Global variables
        let currentUser = null;
        let loyaltyData = null;
        const backendUrl = window.location.hostname === 'localhost' 
            ? 'http://localhost:8001'
            : (typeof process !== 'undefined' && process.env && process.env.REACT_APP_BACKEND_URL) 
                ? process.env.REACT_APP_BACKEND_URL 
                : 'https://web-a11y-upgrade.preview.emergentagent.com';

        // Level configurations
        const LEVELS = {
            'Découvreur': { 
                icon: '🌟', min: 0, max: 499, next: 'Explorateur', 
                class: 'discoverer', position: 1,
                benefits: ['Support client standard', 'Accès aux réservations', 'Newsletters et actualités', 'Programme de parrainage']
            },
            'Explorateur': { 
                icon: '🗺️', min: 500, max: 1499, next: 'Aventurier', 
                class: 'explorer', position: 2,
                benefits: ['Check-in prioritaire dès 14h', 'WiFi premium haute vitesse', 'Late checkout jusqu\'à 13h', 'Welcome drink offert']
            },
            'Aventurier': { 
                icon: '⚔️', min: 1500, max: 2999, next: 'Légende', 
                class: 'adventurer', position: 3,
                benefits: ['Surclassement gratuit (si disponible)', 'Minibar offert', 'Room service 24/7', 'Réservations prioritaires']
            },
            'Légende': { 
                icon: '👑', min: 3000, max: Infinity, next: null, 
                class: 'legend', position: 4,
                benefits: ['Conciergerie 24/7 dédiée', 'Transferts VIP inclus', 'Expériences privées exclusives', 'Chef privé sur demande']
            }
        };

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            initBackgroundVideoiOS();
            AOS.init({ duration: 1000, once: true });
            checkAuthentication();
            loadLoyaltyData();
            initRewards();
        });

        // iOS Video Background Support
        function initBackgroundVideoiOS() {
            const video = document.getElementById('backgroundVideo');
            if (video) {
                const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
                
                if (isIOS) {
                    video.setAttribute('webkit-playsinline', '');
                    video.setAttribute('playsinline', '');
                    video.muted = true;
                    video.defaultMuted = true;
                    video.volume = 0;
                    
                    video.play().catch(error => {
                        function startVideo() {
                            video.play().then(() => {
                                console.log('✅ Vidéo background démarrée sur iOS');
                            }).catch(err => console.log('Erreur vidéo iOS:', err));
                            document.removeEventListener('touchstart', startVideo);
                            document.removeEventListener('click', startVideo);
                        }
                        
                        document.addEventListener('touchstart', startVideo, { once: true });
                        document.addEventListener('click', startVideo, { once: true });
                    });
                } else {
                    video.play().catch(error => {
                        console.log('Erreur autoplay:', error);
                    });
                }
            }
        }

        // Check authentication
        function checkAuthentication() {
            const userData = localStorage.getItem('khanelconcept_user');
            const token = localStorage.getItem('khanelconcept_token');
            
            if (!userData || !token) {
                window.location.href = 'login.html';
                return;
            }

            try {
                currentUser = JSON.parse(userData);
            } catch (error) {
                console.error('Error parsing user data:', error);
                window.location.href = 'login.html';
            }
        }

        // Load loyalty data
        async function loadLoyaltyData() {
            if (!currentUser || !currentUser.id) return;

            const token = localStorage.getItem('khanelconcept_token');
            
            try {
                const response = await fetch(`${backendUrl}/api/members/${currentUser.id}/loyalty`, {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    loyaltyData = await response.json();
                    updateLoyaltyInterface();
                    loadTransactionHistory();
                } else {
                    // Fallback to user data
                    loyaltyData = {
                        current_points: currentUser.points || 100,
                        current_level: currentUser.level || 'Découvreur',
                        next_level: 'Explorateur',
                        points_to_next: 400,
                        total_earned: currentUser.points || 100,
                        total_spent: 0,
                        transactions: []
                    };
                    updateLoyaltyInterface();
                }
            } catch (error) {
                console.error('Error loading loyalty data:', error);
            }
        }

        // Update loyalty interface
        function updateLoyaltyInterface() {
            if (!loyaltyData) return;

            const currentLevel = LEVELS[loyaltyData.current_level] || LEVELS['Découvreur'];
            
            // Update stats
            document.getElementById('currentPoints').textContent = loyaltyData.current_points;
            document.getElementById('totalEarned').textContent = loyaltyData.total_earned;
            document.getElementById('totalSpent').textContent = loyaltyData.total_spent;
            document.getElementById('levelPosition').textContent = `${currentLevel.position}/4`;

            // Update level badge
            const levelBadge = document.getElementById('currentLevelBadge');
            levelBadge.textContent = `${currentLevel.icon} Niveau ${loyaltyData.current_level}`;
            levelBadge.className = `current-level-badge ${currentLevel.class}`;

            // Update progress
            updateProgressBar();

            // Update level cards
            updateLevelCards();
        }

        // Update progress bar
        function updateProgressBar() {
            const currentLevel = LEVELS[loyaltyData.current_level];
            const nextLevel = loyaltyData.next_level ? LEVELS[loyaltyData.next_level] : null;
            
            document.getElementById('currentLevelName').textContent = loyaltyData.current_level;
            
            if (nextLevel) {
                const progress = ((loyaltyData.current_points - currentLevel.min) / (nextLevel.min - currentLevel.min)) * 100;
                const progressBar = document.getElementById('progressBar');
                
                progressBar.style.width = `${Math.min(progress, 100)}%`;
                progressBar.style.background = `var(--${nextLevel.class}-gradient)`;
                
                document.getElementById('progressText').textContent = 
                    `${loyaltyData.current_points} / ${nextLevel.min} points`;
                
                // Update next level benefits
                updateNextLevelBenefits(nextLevel);
            } else {
                document.getElementById('progressBar').style.width = '100%';
                document.getElementById('progressText').textContent = 
                    `${loyaltyData.current_points} points • Niveau Maximum`;
                
                document.getElementById('nextLevelBenefits').style.display = 'none';
            }
        }

        // Update next level benefits
        function updateNextLevelBenefits(nextLevel) {
            const benefitsContainer = document.getElementById('nextLevelBenefits');
            const title = benefitsContainer.querySelector('.next-level-title');
            const benefitsList = benefitsContainer.querySelector('.benefits-list');
            
            title.innerHTML = `🎯 Avantages du niveau ${loyaltyData.next_level} (${nextLevel.min} points)`;
            
            benefitsList.innerHTML = nextLevel.benefits.map(benefit => `
                <li class="benefit-item">
                    <i class="benefit-icon fas fa-star"></i>
                    <span>${benefit}</span>
                </li>
            `).join('');
        }

        // Update level cards
        function updateLevelCards() {
            const levelCards = document.querySelectorAll('.level-card');
            
            levelCards.forEach((card, index) => {
                const levelName = Object.keys(LEVELS)[index];
                const level = LEVELS[levelName];
                const status = card.querySelector('.level-status');
                
                card.classList.remove('current', 'achieved');
                
                if (levelName === loyaltyData.current_level) {
                    card.classList.add('current');
                    status.textContent = 'Actuel';
                    status.className = 'level-status current';
                } else if (level.position < LEVELS[loyaltyData.current_level].position) {
                    card.classList.add('achieved');
                    status.textContent = 'Débloqué';
                    status.className = 'level-status achieved';
                } else {
                    status.textContent = `${level.min} points`;
                    status.className = 'level-status upcoming';
                }
            });
        }

        // Load transaction history
        function loadTransactionHistory() {
            const transactionsList = document.getElementById('transactionsList');
            
            if (loyaltyData.transactions && loyaltyData.transactions.length > 0) {
                transactionsList.innerHTML = loyaltyData.transactions.map(transaction => {
                    const timeAgo = getTimeAgo(new Date(transaction.createdAt));
                    const isPositive = transaction.type === 'earn' || transaction.type === 'bonus';
                    const sign = isPositive ? '+' : '-';
                    
                    return `
                        <div class="transaction-item ${transaction.type}">
                            <div class="transaction-icon ${transaction.type}">
                                <i class="fas fa-${getTransactionIcon(transaction.type)}"></i>
                            </div>
                            <div class="transaction-content">
                                <div class="transaction-title">${transaction.description}</div>
                                <div class="transaction-desc">${transaction.reference || 'Activité système'}</div>
                            </div>
                            <div class="flex flex-col items-end">
                                <div class="transaction-amount ${transaction.type}">
                                    ${sign}${transaction.amount} pts
                                </div>
                                <div class="transaction-time">${timeAgo}</div>
                            </div>
                        </div>
                    `;
                }).join('');
            } else {
                transactionsList.innerHTML = `
                    <div class="transaction-item bonus">
                        <div class="transaction-icon bonus">
                            <i class="fas fa-gift"></i>
                        </div>
                        <div class="transaction-content">
                            <div class="transaction-title">Bonus d'inscription</div>
                            <div class="transaction-desc">Bienvenue chez KhanelConcept !</div>
                        </div>
                        <div class="flex flex-col items-end">
                            <div class="transaction-amount bonus">+100 pts</div>
                            <div class="transaction-time">Aujourd'hui</div>
                        </div>
                    </div>
                `;
            }
        }

        // Get transaction icon
        function getTransactionIcon(type) {
            const icons = {
                'earn': 'arrow-up',
                'spend': 'arrow-down',
                'bonus': 'gift'
            };
            return icons[type] || 'circle';
        }

        // Get time ago
        function getTimeAgo(date) {
            const now = new Date();
            const diff = now - date;
            const minutes = Math.floor(diff / (1000 * 60));
            const hours = Math.floor(diff / (1000 * 60 * 60));
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));

            if (minutes < 60) return `Il y a ${minutes} min`;
            if (hours < 24) return `Il y a ${hours}h`;
            if (days < 7) return `Il y a ${days} jours`;
            return date.toLocaleDateString('fr-FR');
        }

        // Initialize rewards
        function initRewards() {
            showRewardTab('nights'); // Show default tab
        }

        // Show reward tab
        function showRewardTab(category) {
            // Update active tab
            document.querySelectorAll('.reward-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // Load rewards for category
            loadRewards(category);
        }

        // Load rewards
        function loadRewards(category) {
            const rewardsContainer = document.getElementById('rewardsContent');
            const currentPoints = loyaltyData?.current_points || 100;

            const rewardsData = {
                nights: [
                    { title: 'Nuit Gratuite Villa Standard', cost: 2000, description: 'Une nuit dans une villa 2-4 personnes de votre choix' },
                    { title: 'Nuit Gratuite Villa Premium', cost: 3500, description: 'Une nuit dans une villa 6-8 personnes avec piscine' },
                    { title: 'Nuit Gratuite Villa Prestige', cost: 5000, description: 'Une nuit dans nos villas les plus luxueuses' },
                    { title: 'Week-end Découverte', cost: 4000, description: '2 nuits pour découvrir nos nouvelles destinations' }
                ],
                services: [
                    { title: 'Surclassement Villa', cost: 500, description: 'Upgrade gratuit vers la catégorie supérieure' },
                    { title: 'Chef Privé - Dîner', cost: 800, description: 'Dîner préparé par un chef privé martiniquais' },
                    { title: 'Spa à Domicile', cost: 1200, description: 'Séance de massage relaxant dans votre villa' },
                    { title: 'Excursion Privée', cost: 1500, description: 'Journée découverte avec guide privatisé' }
                ],
                experiences: [
                    { title: 'Coucher de Soleil en Catamaran', cost: 2500, description: 'Sortie exclusive au coucher du soleil avec champagne' },
                    { title: 'Plongée sous-marine VIP', cost: 2000, description: 'Session plongée avec instructeur privé' },
                    { title: 'Dégustation Rhum Premium', cost: 1800, description: 'Visite privée de distillerie avec dégustation' },
                    { title: 'Hélicoptère Survol Île', cost: 6000, description: 'Tour en hélicoptère de la Martinique (30min)' }
                ],
                merchandise: [
                    { title: 'T-shirt KhanelConcept', cost: 200, description: 'T-shirt premium avec logo brodé' },
                    { title: 'Sac de Plage Luxe', cost: 350, description: 'Sac en toile personnalisé KhanelConcept' },
                    { title: 'Rhum Édition Limitée', cost: 500, description: 'Bouteille collector KhanelConcept' },
                    { title: 'Coffret Produits Locaux', cost: 750, description: 'Épices, confitures et spécialités martiniquaises' }
                ]
            };

            const rewards = rewardsData[category] || [];
            
            rewardsContainer.innerHTML = rewards.map(reward => {
                const canAfford = currentPoints >= reward.cost;
                return `
                    <div class="reward-card">
                        <div class="reward-header">
                            <div class="reward-icon">
                                <i class="fas fa-${getRewardIcon(category)}"></i>
                            </div>
                            <div class="reward-title">${reward.title}</div>
                            <div class="reward-cost">${reward.cost} pts</div>
                        </div>
                        <div class="reward-description">${reward.description}</div>
                        <button class="reward-button" ${!canAfford ? 'disabled' : ''} onclick="redeemReward('${reward.title}', ${reward.cost})">
                            ${canAfford ? 'Échanger' : 'Points insuffisants'}
                        </button>
                    </div>
                `;
            }).join('');
        }

        // Get reward icon
        function getRewardIcon(category) {
            const icons = {
                nights: 'bed',
                services: 'concierge-bell',
                experiences: 'compass',
                merchandise: 'gift'
            };
            return icons[category] || 'star';
        }

        // Redeem reward
        function redeemReward(title, cost) {
            if (confirm(`Voulez-vous échanger ${cost} points contre "${title}" ?`)) {
                // Here you would call the backend API to process the reward redemption
                alert('Félicitations ! Votre récompense a été échangée. Vous recevrez un email de confirmation.');
                
                // Update points locally (in real app, this would be done by the backend)
                if (loyaltyData) {
                    loyaltyData.current_points -= cost;
                    loyaltyData.total_spent += cost;
                    updateLoyaltyInterface();
                    loadRewards(document.querySelector('.reward-tab.active').textContent.toLowerCase().replace(' ', ''));
                }
            }
        }

        // Logout function
        function logout() {
            if (confirm('Êtes-vous sûr de vouloir vous déconnecter ?')) {
                localStorage.removeItem('khanelconcept_user');
                localStorage.removeItem('khanelconcept_token');
                window.location.href = 'login.html';
            }
        }
    </script>
</body>
</html>