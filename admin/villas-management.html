<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AllInclusive 2.0 - Gestion des Villas</title>
    
    <!-- External CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Leaflet for maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Dropzone for file uploads -->
    <link rel="stylesheet" href="https://unpkg.com/dropzone@5/dist/min/dropzone.min.css" type="text/css" />
    <script src="https://unpkg.com/dropzone@5/dist/min/dropzone.min.js"></script>
    
    <style>
        :root {
            /* Light Theme Colors */
            --primary-50: #f0f9ff;
            --primary-100: #e0f2fe;
            --primary-500: #0ea5e9;
            --primary-600: #0284c7;
            --primary-700: #0369a1;
            
            --gray-50: #f8fafc;
            --gray-100: #f1f5f9;
            --gray-200: #e2e8f0;
            --gray-300: #cbd5e1;
            --gray-400: #94a3b8;
            --gray-500: #64748b;
            --gray-600: #475569;
            --gray-700: #334155;
            --gray-800: #1e293b;
            --gray-900: #0f172a;
            
            --success-50: #f0fdf4;
            --success-500: #22c55e;
            --success-600: #16a34a;
            --warning-50: #fffbeb;
            --warning-500: #f59e0b;
            --error-50: #fef2f2;
            --error-500: #ef4444;
            
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --border-primary: #e2e8f0;
            
            --sidebar-width: 280px;
            --header-height: 70px;
            --border-radius: 12px;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        
        [data-theme="dark"] {
            --primary-50: #0c1220;
            --primary-100: #1e293b;
            --primary-500: #3b82f6;
            --primary-600: #2563eb;
            --primary-700: #1d4ed8;
            
            --gray-50: #0f172a;
            --gray-100: #1e293b;
            --gray-200: #334155;
            --gray-300: #475569;
            --gray-400: #64748b;
            --gray-500: #94a3b8;
            --gray-600: #cbd5e1;
            --gray-700: #e2e8f0;
            --gray-800: #f1f5f9;
            --gray-900: #f8fafc;
            
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --border-primary: #334155;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
        }
        
        /* Layout */
        .villa-management-layout {
            display: flex;
            min-height: 100vh;
        }
        
        .content-area {
            flex: 1;
            padding: 2rem;
            max-width: 100%;
        }
        
        /* Header */
        .page-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .page-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .page-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }
        
        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
        }
        
        .btn-primary {
            background: var(--primary-500);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-600);
        }
        
        .btn-secondary {
            background: var(--gray-100);
            color: var(--text-primary);
            border: 1px solid var(--border-primary);
        }
        
        .btn-secondary:hover {
            background: var(--gray-200);
        }
        
        .btn-success {
            background: var(--success-500);
            color: white;
        }
        
        .btn-success:hover {
            background: var(--success-600);
        }
        
        /* Search and Filters */
        .filters-section {
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-primary);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            align-items: end;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .form-label {
            font-weight: 500;
            color: var(--text-primary);
            font-size: 0.875rem;
        }
        
        .form-input {
            padding: 0.75rem;
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 0.875rem;
            transition: border-color 0.2s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px var(--primary-50);
        }
        
        /* Villa Cards Grid */
        .villas-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 2rem;
        }
        
        .villa-card {
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-primary);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .villa-card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }
        
        .villa-card-image {
            position: relative;
            height: 200px;
            overflow: hidden;
        }
        
        .villa-card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .villa-card:hover .villa-card-image img {
            transform: scale(1.05);
        }
        
        .villa-status-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-available {
            background: var(--success-50);
            color: var(--success-600);
        }
        
        .status-occupied {
            background: var(--error-50);
            color: var(--error-500);
        }
        
        .status-maintenance {
            background: var(--warning-50);
            color: var(--warning-500);
        }
        
        .villa-card-content {
            padding: 1.5rem;
        }
        
        .villa-card-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 1rem;
        }
        
        .villa-name {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }
        
        .villa-location {
            font-size: 0.875rem;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        
        .villa-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-600);
        }
        
        .villa-price-unit {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        .villa-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin: 1.5rem 0;
            padding: 1rem;
            background: var(--gray-50);
            border-radius: 8px;
        }
        
        .villa-stat {
            text-align: center;
        }
        
        .villa-stat-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .villa-stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .villa-amenities {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }
        
        .amenity-tag {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.75rem;
            background: var(--gray-100);
            border-radius: 9999px;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }
        
        .villa-actions {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }
        
        .action-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            background: var(--bg-primary);
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .action-btn:hover {
            background: var(--gray-50);
            color: var(--text-primary);
        }
        
        .action-btn.primary {
            background: var(--primary-50);
            color: var(--primary-600);
            border-color: var(--primary-200);
        }
        
        .action-btn.primary:hover {
            background: var(--primary-100);
        }
        
        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }
        
        .modal.active .modal-content {
            transform: translateY(0);
        }
        
        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-primary);
        }
        
        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .modal-close {
            width: 40px;
            height: 40px;
            border: none;
            background: var(--gray-100);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-secondary);
            transition: all 0.2s ease;
        }
        
        .modal-close:hover {
            background: var(--gray-200);
            color: var(--text-primary);
        }
        
        .modal-body {
            padding: 1.5rem;
        }
        
        /* Villa Form */
        .villa-form {
            display: grid;
            gap: 2rem;
        }
        
        .form-section {
            display: grid;
            gap: 1rem;
        }
        
        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--primary-500);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }
        
        .textarea-input {
            min-height: 100px;
            resize: vertical;
        }
        
        /* Image Gallery */
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
        }
        
        .gallery-item {
            position: relative;
            aspect-ratio: 1;
            border-radius: 8px;
            overflow: hidden;
            background: var(--gray-100);
        }
        
        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .gallery-item-actions {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            display: flex;
            gap: 0.25rem;
        }
        
        .gallery-action-btn {
            width: 24px;
            height: 24px;
            border: none;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.75rem;
            transition: all 0.2s ease;
        }
        
        .gallery-action-btn.delete {
            background: var(--error-500);
            color: white;
        }
        
        .gallery-action-btn.delete:hover {
            background: var(--error-600);
        }
        
        /* Map Container */
        .map-container {
            height: 300px;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid var(--border-primary);
        }
        
        /* Dropzone Styles */
        .dropzone {
            border: 2px dashed var(--border-primary) !important;
            border-radius: 8px !important;
            background: var(--gray-50) !important;
            min-height: 200px !important;
        }
        
        .dropzone .dz-message {
            color: var(--text-secondary) !important;
        }
        
        /* Loading States */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            color: var(--text-secondary);
        }
        
        .spinner {
            width: 24px;
            height: 24px;
            border: 2px solid var(--gray-200);
            border-top: 2px solid var(--primary-500);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 0.5rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .content-area {
                padding: 1rem;
            }
            
            .page-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .page-actions {
                justify-content: stretch;
            }
            
            .btn {
                justify-content: center;
            }
            
            .villas-grid {
                grid-template-columns: 1fr;
            }
            
            .filters-grid {
                grid-template-columns: 1fr;
            }
            
            .villa-stats {
                grid-template-columns: 1fr;
            }
            
            .modal {
                padding: 1rem;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }
        
        
        /* New Villa Card Styles */
        .villa-image-container {
            position: relative;
            height: 200px;
            overflow: hidden;
        }
        
        .villa-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .villa-card:hover .villa-image {
            transform: scale(1.05);
        }
        
        .villa-status {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-active {
            background: var(--success-50);
            color: var(--success-600);
        }
        
        .status-inactive {
            background: var(--error-50);
            color: var(--error-500);
        }
        
        .villa-rating {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
        }
        
        .villa-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }
        
        .villa-location {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }
        
        .villa-quick-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background: var(--gray-50);
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }
        
        .performance-indicators {
            margin-bottom: 1rem;
        }
        
        .performance-bar {
            margin-bottom: 0.5rem;
        }
        
        .performance-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 0.25rem;
        }
        
        .progress {
            height: 6px;
            background: var(--gray-200);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: var(--success-500);
            transition: width 0.3s ease;
        }
        
        .bg-success {
            background-color: var(--success-500) !important;
        }
        
        .revenue-info {
            text-align: center;
            padding: 0.75rem;
            background: var(--success-50);
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        
        .fw-bold {
            font-weight: 700;
        }
        
        .text-success {
            color: var(--success-600);
        }
        
        .text-muted {
            color: var(--text-secondary);
        }
        
        .villa-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .btn-sm {
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
        }
        
        .me-1 {
            margin-right: 0.25rem;
        }
        
        .mb-3 {
            margin-bottom: 1rem;
        }
        
        .h-100 {
            height: 100%;
        }
        
        .card-body {
            padding: 1.5rem;
        }
        
        .p-3 {
            padding: 1rem;
        }
        
        .col-12 {
            width: 100%;
        }
        
        .col-lg-4 {
            width: 33.333333%;
        }
        
        .col-md-6 {
            width: 50%;
        }
        
        .mb-4 {
            margin-bottom: 1.5rem;
        }
        
        @media (max-width: 992px) {
            .col-lg-4 {
                width: 50%;
            }
        }
        
        @media (max-width: 768px) {
            .col-lg-4,
            .col-md-6 {
                width: 100%;
            }
        }
        
        /* Utilities */
        .text-center { text-align: center; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-8 { margin-bottom: 2rem; }
        .hidden { display: none; }
    </style>
</head>
<body data-theme="light">
    <div class="video-background">
  <video autoplay loop muted playsinline poster="images/hero-poster.jpg">
    <source src="https://res.cloudinary.com/ddulasmtz/video/upload/v1752950782/background-video.webm" type="video/webm">
    Votre navigateur ne supporte pas la vidéo HTML5.
  </video>
  <div class="video-overlay"></div>
</div>

    <div class="villa-management-layout">
        <main class="content-area">
            <!-- Page Header -->
            <div class="page-header">
                <div>
                    <h1 class="page-title">Gestion des Villas</h1>
                    <p style="color: var(--text-secondary); margin-top: 0.5rem;">Gérez vos propriétés, tarifs et disponibilités</p>
                </div>
                <div class="page-actions">
                    <button class="btn btn-secondary" id="exportBtn">
                        <i class="fas fa-download"></i>
                        Exporter
                    </button>
                    <button class="btn btn-primary" id="addVillaBtn">
                        <i class="fas fa-plus"></i>
                        Nouvelle Villa
                    </button>
                </div>
            </div>
            
            <!-- Filters Section -->
            <div class="filters-section">
                <div class="filters-grid">
                    <div class="form-group">
                        <label class="form-label">Rechercher</label>
                        <input type="text" class="form-input" id="villaSearch" placeholder="Nom, localisation...">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Catégorie</label>
                        <select class="form-input" id="categoryFilter">
                            <option value="">Toutes les catégories</option>
                            <option value="sejour">Séjour</option>
                            <option value="fete">Fête</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Statut</label>
                        <select class="form-input" id="statusFilter">
                            <option value="">Tous les statuts</option>
                            <option value="active">Actif</option>
                            <option value="inactive">Inactif</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Type</label>
                        <select class="form-input" id="typeFilter">
                            <option value="">Tous les types</option>
                            <option value="F3">F3</option>
                            <option value="F5">F5</option>
                            <option value="F6">F6</option>
                            <option value="F7">F7</option>
                            <option value="Studio">Studio</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Prix</label>
                        <select class="form-input" id="priceFilter">
                            <option value="">Tous les prix</option>
                            <option value="0-500">0€ - 500€</option>
                            <option value="500-1000">500€ - 1000€</option>
                            <option value="1000-2000">1000€ - 2000€</option>
                            <option value="2000+">2000€+</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <button class="btn btn-secondary" id="resetFiltersBtn">
                            <i class="fas fa-times"></i>
                            Réinitialiser
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Loading State -->
            <div id="loadingState" class="loading">
                <div class="spinner"></div>
                Chargement des villas...
            </div>
            
            <!-- Villas Grid -->
            <div class="villas-grid" id="villasGrid">
                <!-- Villa cards will be populated here -->
            </div>
            
            <!-- Empty State -->
            <div id="emptyState" class="text-center" style="padding: 4rem 2rem; display: none;">
                <i class="fas fa-home" style="font-size: 4rem; color: var(--gray-400); margin-bottom: 1rem;"></i>
                <h3 style="font-size: 1.5rem; color: var(--text-primary); margin-bottom: 1rem;">Aucune villa trouvée</h3>
                <p style="color: var(--text-secondary); margin-bottom: 2rem;">Aucune villa ne correspond à vos critères de recherche.</p>
                <button class="btn btn-primary" id="addFirstVillaBtn">
                    <i class="fas fa-plus"></i>
                    Ajouter une villa
                </button>
            </div>
        </main>
    </div>
    
    <!-- Villa Modal -->
    <div class="modal" id="villaModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Nouvelle Villa</h2>
                <button class="modal-close" id="closeModalBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form class="villa-form" id="villaForm">
                    <!-- Basic Information -->
                    <div class="form-section">
                        <h3 class="section-title">Informations de base</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Nom de la villa *</label>
                                <input type="text" class="form-input" id="villaName" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Type *</label>
                                <select class="form-input" id="villaType" required>
                                    <option value="">Sélectionner un type</option>
                                    <option value="F3">F3</option>
                                    <option value="F5">F5</option>
                                    <option value="F6">F6</option>
                                    <option value="F7">F7</option>
                                    <option value="Studio">Studio</option>
                                    <option value="Location journée">Location journée</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Localisation *</label>
                                <input type="text" class="form-input" id="villaLocation" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Capacité (personnes) *</label>
                                <input type="number" class="form-input" id="villaGuests" min="1" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Description</label>
                            <textarea class="form-input textarea-input" id="villaDescription" rows="4"></textarea>
                        </div>
                    </div>
                    
                    <!-- Pricing -->
                    <div class="form-section">
                        <h3 class="section-title">Tarification</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Prix de base (€) *</label>
                                <input type="number" class="form-input" id="villaBasePrice" min="0" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Prix weekend (€)</label>
                                <input type="number" class="form-input" id="villaWeekendPrice" min="0" step="0.01">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Prix semaine (€)</label>
                                <input type="number" class="form-input" id="villaWeekPrice" min="0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Prix haute saison (€)</label>
                                <input type="number" class="form-input" id="villaHighSeasonPrice" min="0" step="0.01">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Services & Amenities -->
                    <div class="form-section">
                        <h3 class="section-title">Services et équipements</h3>
                        <div class="form-group">
                            <label class="form-label">Services inclus</label>
                            <textarea class="form-input textarea-input" id="villaServices" rows="3" placeholder="Ex: Piscine, WiFi, Climatisation, Parking..."></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Équipements détaillés</label>
                            <div id="amenitiesContainer" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 0.5rem;">
                                <!-- Amenities checkboxes will be generated here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Images -->
                    <div class="form-section">
                        <h3 class="section-title">Galerie photos</h3>
                        <div class="form-group">
                            <label class="form-label">Images de la villa</label>
                            <div id="imageDropzone" class="dropzone">
                                <div class="dz-message">
                                    <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
                                    Glissez-déposez vos images ici ou cliquez pour sélectionner
                                </div>
                            </div>
                        </div>
                        <div class="image-gallery" id="imageGallery">
                            <!-- Uploaded images will appear here -->
                        </div>
                    </div>
                    
                    <!-- Location Map -->
                    <div class="form-section">
                        <h3 class="section-title">Géolocalisation</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Latitude</label>
                                <input type="number" class="form-input" id="villaLatitude" step="any">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Longitude</label>
                                <input type="number" class="form-input" id="villaLongitude" step="any">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Carte interactive</label>
                            <div class="map-container" id="villaMap"></div>
                        </div>
                    </div>
                    
                    <!-- Form Actions -->
                    <div class="form-section">
                        <div style="display: flex; gap: 1rem; justify-content: flex-end; padding-top: 1rem; border-top: 1px solid var(--border-primary);">
                            <button type="button" class="btn btn-secondary" id="cancelBtn">
                                Annuler
                            </button>
                            <button type="submit" class="btn btn-success" id="saveBtn">
                                <i class="fas fa-save"></i>
                                Enregistrer
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Statistics Cards (to be added to the page header area) -->
    <div id="statsCards" style="display: none;">
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body text-center">
                        <h3 id="totalVillasCount">0</h3>
                        <p class="text-muted">Villas actives</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body text-center">
                        <h3 id="totalRevenueAmount">€0</h3>
                        <p class="text-muted">Revenus totaux</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body text-center">
                        <h3 id="avgOccupancyRate">0%</h3>
                        <p class="text-muted">Taux d'occupation moyen</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body text-center">
                        <h3 id="avgRatingValue">0.0</h3>
                        <p class="text-muted">Note moyenne</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Villa Details Modal -->
    <div class="modal fade" id="villaDetailsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Détails de la villa</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <img id="currentGalleryImage" src="" alt="" class="img-fluid rounded" style="width: 100%; height: 300px; object-fit: cover;">
                                <div class="d-flex justify-content-between align-items-center mt-2">
                                    <button id="prevImageBtn" class="btn btn-sm btn-outline-primary" onclick="previousImage()">
                                        <i class="fas fa-chevron-left"></i>
                                    </button>
                                    <span id="imageCounter">1 / 1</span>
                                    <button id="nextImageBtn" class="btn btn-sm btn-outline-primary" onclick="nextImage()">
                                        <i class="fas fa-chevron-right"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h4 id="villaDetailsName">Villa Name</h4>
                            <p><i class="fas fa-map-marker-alt"></i> <span id="villaDetailsLocation">Location</span></p>
                            <p><strong>Prix:</strong> <span id="villaDetailsPrice">€0</span></p>
                            <p><strong>Capacité:</strong> <span id="villaDetailsGuests">0 personnes</span></p>
                            <p><strong>Équipements:</strong> <span id="villaDetailsFeatures">Aucun</span></p>
                            <p><strong>Note:</strong> <span id="villaDetailsRating">N/A</span></p>
                            <p><strong>Taux d'occupation:</strong> <span id="villaDetailsOccupancy">0%</span></p>
                            <p><strong>Revenus:</strong> <span id="villaDetailsRevenue">€0</span></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Edit Villa Modal -->
    <div class="modal fade" id="editVillaModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Modifier la villa</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editVillaForm">
                        <div class="mb-3">
                            <label class="form-label">Nom de la villa</label>
                            <input type="text" class="form-control" id="editVillaName" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Localisation</label>
                            <input type="text" class="form-control" id="editVillaLocation" required>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Prix (€)</label>
                                    <input type="number" class="form-control" id="editVillaPrice" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Capacité</label>
                                    <input type="number" class="form-control" id="editVillaGuests" required>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Équipements</label>
                            <textarea class="form-control" id="editVillaFeatures" rows="3"></textarea>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Catégorie</label>
                                    <select class="form-control" id="editVillaCategory">
                                        <option value="sejour">Séjour</option>
                                        <option value="fete">Fête</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Statut</label>
                                    <select class="form-control" id="editVillaStatus">
                                        <option value="active">Actif</option>
                                        <option value="inactive">Inactif</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-primary" onclick="saveVillaChanges()">Enregistrer</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Pricing Modal -->
    <div class="modal fade" id="pricingModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Gestion des tarifs</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="pricingForm">
                        <div class="mb-3">
                            <label class="form-label">Prix de base (€)</label>
                            <input type="number" class="form-control" id="basePrice" step="0.01" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Prix weekend (€)</label>
                            <input type="number" class="form-control" id="weekendPrice" step="0.01">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Prix haute saison (€)</label>
                            <input type="number" class="form-control" id="highSeasonPrice" step="0.01">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-primary" onclick="savePricingChanges()">Enregistrer</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast Container -->
    <div id="toastContainer" class="position-fixed top-0 end-0 p-3" style="z-index: 11000;"></div>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // ============ VILLA DATA MANAGEMENT ============
        
        // Enhanced villa data with real backend integration
        let villasData = [];
        let filteredVillas = [];
        let currentVilla = null;
        let currentGalleryIndex = 0;
        
        // Fetch villas from backend
        async function fetchVillasData() {
            try {
                const backendUrl = window.location.origin;
                const adminToken = localStorage.getItem('admin_token') || localStorage.getItem('adminToken');
                
                const response = await fetch(`${backendUrl}/api/admin/villas`, {
                    headers: adminToken ? {
                        'Authorization': `Bearer ${adminToken}`
                    } : {}
                });
                
                if (response.ok) {
                    villasData = await response.json();
                    console.log(`✅ Loaded ${villasData.length} villas from backend`);
                } else {
                    console.warn('⚠️ Backend not available, using mock data');
                    villasData = generateMockVillasData();
                }
                
                filteredVillas = [...villasData];
                displayVillas();
                updateVillaStats();
                initializeFilters();
                
            } catch (error) {
                console.error('Error fetching villas:', error);
                villasData = generateMockVillasData();
                filteredVillas = [...villasData];
                displayVillas();
                updateVillaStats();
                initializeFilters();
            }
        }
        
        // Generate comprehensive mock data
        function generateMockVillasData() {
            return [
                {
                    id: 1,
                    name: "Villa F3 Petit Macabou",
                    location: "Petit Macabou au Vauclin",
                    price: 850,
                    guests: 6,
                    guestsDetail: "6 personnes + 9 invités",
                    features: "Sauna, Jacuzzi, 2 douches extérieures",
                    category: "sejour",
                    image: "../images/Villa_F3_Petit_Macabou/01_piscine_exterieur.jpg",
                    gallery: [
                        "../images/Villa_F3_Petit_Macabou/01_piscine_exterieur.jpg",
                        "../images/Villa_F3_Petit_Macabou/02_terrasse_salon_exterieur.jpg",
                        "../images/Villa_F3_Petit_Macabou/03_salle_de_bain_moderne.jpg"
                    ],
                    status: "active",
                    occupancyRate: 85,
                    revenue: 15300,
                    rating: 4.8,
                    lastBooked: "2025-01-20",
                    pricingRules: {
                        base: 850,
                        weekend: 950,
                        highSeason: 1100
                    }
                },
                {
                    id: 2,
                    name: "Villa F5 Ste Anne",
                    location: "Quartier Les Anglais, Ste Anne",
                    price: 1300,
                    guests: 10,
                    guestsDetail: "10 personnes + 15 invités",
                    features: "Piscine, décoration rose distinctive",
                    category: "sejour",
                    image: "../images/Villa_F5_Ste_Anne/01_piscine_principale.jpg",
                    gallery: [
                        "../images/Villa_F5_Ste_Anne/01_piscine_principale.jpg",
                        "../images/Villa_F5_Ste_Anne/02_piscine_vue_aerienne.jpg"
                    ],
                    status: "active",
                    occupancyRate: 92,
                    revenue: 23400,
                    rating: 4.9,
                    lastBooked: "2025-01-28",
                    pricingRules: {
                        base: 1300,
                        weekend: 1450,
                        highSeason: 1650
                    }
                },
                {
                    id: 3,
                    name: "Villa F6 Petit Macabou",
                    location: "Petit Macabou au Vauclin",
                    price: 2000,
                    guests: 13,
                    guestsDetail: "10 à 13 personnes (14 max)",
                    features: "Piscine, fêtes jusqu'à 150 convives",
                    category: "sejour",
                    image: "../images/Villa_F6_Petit_Macabou/02_salle_de_bain.jpg",
                    gallery: [
                        "../images/Villa_F6_Petit_Macabou/02_salle_de_bain.jpg",
                        "../images/Villa_F6_Petit_Macabou/03_chambre_studio.jpg"
                    ],
                    status: "active",
                    occupancyRate: 78,
                    revenue: 31200,
                    rating: 4.7,
                    lastBooked: "2025-01-25",
                    pricingRules: {
                        base: 2000,
                        weekend: 2200,
                        highSeason: 2500
                    }
                }
            ];
        }
        
        // Update villa statistics
        function updateVillaStats() {
            const activeVillas = villasData.filter(v => v.status === 'active').length;
            const totalRevenue = villasData.reduce((sum, v) => sum + (v.revenue || 0), 0);
            const avgOccupancy = villasData.reduce((sum, v) => sum + (v.occupancyRate || 0), 0) / villasData.length;
            const avgRating = villasData.reduce((sum, v) => sum + (v.rating || 0), 0) / villasData.length;
            
            // Update stat cards
            document.getElementById('totalVillasCount').textContent = activeVillas;
            document.getElementById('totalRevenueAmount').textContent = `€${totalRevenue.toLocaleString()}`;
            document.getElementById('avgOccupancyRate').textContent = `${Math.round(avgOccupancy)}%`;
            document.getElementById('avgRatingValue').textContent = avgRating.toFixed(1);
        }
        
        // Display villas in grid
        function displayVillas() {
            const container = document.getElementById('villasGrid');
            if (!container) return;
            
            if (filteredVillas.length === 0) {
                container.innerHTML = `
                    <div class="col-12">
                        <div class="card text-center p-5">
                            <i class="fas fa-search fa-3x text-muted mb-3"></i>
                            <h5>Aucune villa trouvée</h5>
                            <p class="text-muted">Essayez de modifier vos critères de recherche</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = filteredVillas.map(villa => `
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="villa-card h-100">
                        <div class="villa-image-container">
                            <img src="${villa.image || 'https://via.placeholder.com/350x200/4facfe/ffffff?text=🏖️'}" 
                                 alt="${villa.name}" 
                                 class="villa-image"
                                 onerror="this.src='https://via.placeholder.com/350x200/4facfe/ffffff?text=🏖️'">
                            <div class="villa-status ${villa.status === 'active' ? 'status-active' : 'status-inactive'}">
                                ${villa.status === 'active' ? 'Actif' : 'Inactif'}
                            </div>
                            <div class="villa-rating">
                                <i class="fas fa-star"></i>
                                ${villa.rating || '4.5'}
                            </div>
                        </div>
                        
                        <div class="card-body p-3">
                            <h5 class="villa-title">${villa.name}</h5>
                            <p class="villa-location">
                                <i class="fas fa-map-marker-alt me-1"></i>
                                ${villa.location}
                            </p>
                            
                            <!-- Quick Stats -->
                            <div class="villa-quick-stats mb-3">
                                <div class="stat-item">
                                    <i class="fas fa-users"></i>
                                    <span>${villa.guests} pers.</span>
                                </div>
                                <div class="stat-item">
                                    <i class="fas fa-euro-sign"></i>
                                    <span>${villa.price}€</span>
                                </div>
                                <div class="stat-item">
                                    <i class="fas fa-percentage"></i>
                                    <span>${villa.occupancyRate || 0}%</span>
                                </div>
                            </div>
                            
                            <!-- Performance Indicators -->
                            <div class="performance-indicators mb-3">
                                <div class="performance-bar">
                                    <div class="performance-label">Taux d'occupation</div>
                                    <div class="progress" style="height: 6px;">
                                        <div class="progress-bar bg-success" style="width: ${villa.occupancyRate || 0}%"></div>
                                    </div>
                                    <small class="text-muted">${villa.occupancyRate || 0}%</small>
                                </div>
                            </div>
                            
                            <!-- Revenue Info -->
                            <div class="revenue-info mb-3">
                                <small class="text-muted">Revenus générés</small>
                                <div class="fw-bold text-success">€${(villa.revenue || 0).toLocaleString()}</div>
                            </div>
                            
                            <!-- Action Buttons -->
                            <div class="villa-actions">
                                <button class="btn btn-primary btn-sm" onclick="viewVillaDetails(${villa.id})">
                                    <i class="fas fa-eye me-1"></i>Détails
                                </button>
                                <button class="btn btn-warning btn-sm" onclick="editVilla(${villa.id})">
                                    <i class="fas fa-edit me-1"></i>Modifier
                                </button>
                                <button class="btn btn-info btn-sm" onclick="manageCalendar(${villa.id})">
                                    <i class="fas fa-calendar me-1"></i>Calendrier
                                </button>
                                <button class="btn btn-success btn-sm" onclick="managePricing(${villa.id})">
                                    <i class="fas fa-tags me-1"></i>Prix
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        // Villa management functions
        function viewVillaDetails(villaId) {
            const villa = villasData.find(v => v.id === villaId);
            if (!villa) return;
            
            currentVilla = villa;
            currentGalleryIndex = 0;
            
            // Populate modal with villa details
            document.getElementById('villaDetailsName').textContent = villa.name;
            document.getElementById('villaDetailsLocation').textContent = villa.location;
            document.getElementById('villaDetailsPrice').textContent = `${villa.price}€`;
            document.getElementById('villaDetailsGuests').textContent = villa.guestsDetail || `${villa.guests} personnes`;
            document.getElementById('villaDetailsFeatures').textContent = villa.features || 'Aucune information';
            document.getElementById('villaDetailsRating').textContent = villa.rating || 'N/A';
            document.getElementById('villaDetailsOccupancy').textContent = `${villa.occupancyRate || 0}%`;
            document.getElementById('villaDetailsRevenue').textContent = `€${(villa.revenue || 0).toLocaleString()}`;
            
            // Update gallery
            if (villa.gallery && villa.gallery.length > 0) {
                updateGalleryDisplay();
            }
            
            // Show modal
            const modal = new bootstrap.Modal(document.getElementById('villaDetailsModal'));
            modal.show();
        }
        
        function updateGalleryDisplay() {
            if (!currentVilla || !currentVilla.gallery) return;
            
            const gallery = currentVilla.gallery;
            const currentImage = document.getElementById('currentGalleryImage');
            const imageCounter = document.getElementById('imageCounter');
            
            if (currentImage) {
                currentImage.src = gallery[currentGalleryIndex] || 'https://via.placeholder.com/600x400/4facfe/ffffff?text=🏖️';
                currentImage.alt = `${currentVilla.name} - Image ${currentGalleryIndex + 1}`;
            }
            
            if (imageCounter) {
                imageCounter.textContent = `${currentGalleryIndex + 1} / ${gallery.length}`;
            }
            
            // Update navigation buttons
            const prevBtn = document.getElementById('prevImageBtn');
            const nextBtn = document.getElementById('nextImageBtn');
            
            if (prevBtn) prevBtn.disabled = currentGalleryIndex === 0;
            if (nextBtn) nextBtn.disabled = currentGalleryIndex === gallery.length - 1;
        }
        
        function previousImage() {
            if (currentGalleryIndex > 0) {
                currentGalleryIndex--;
                updateGalleryDisplay();
            }
        }
        
        function nextImage() {
            if (currentVilla && currentVilla.gallery && currentGalleryIndex < currentVilla.gallery.length - 1) {
                currentGalleryIndex++;
                updateGalleryDisplay();
            }
        }
        
        function editVilla(villaId) {
            const villa = villasData.find(v => v.id === villaId);
            if (!villa) return;
            
            currentVilla = villa;
            
            // Populate edit form
            document.getElementById('editVillaName').value = villa.name || '';
            document.getElementById('editVillaLocation').value = villa.location || '';
            document.getElementById('editVillaPrice').value = villa.price || '';
            document.getElementById('editVillaGuests').value = villa.guests || '';
            document.getElementById('editVillaFeatures').value = villa.features || '';
            document.getElementById('editVillaCategory').value = villa.category || 'sejour';
            document.getElementById('editVillaStatus').value = villa.status || 'active';
            
            // Show modal
            const modal = new bootstrap.Modal(document.getElementById('editVillaModal'));
            modal.show();
        }
        
        function saveVillaChanges() {
            if (!currentVilla) return;
            
            // Get form data
            const formData = {
                name: document.getElementById('editVillaName').value,
                location: document.getElementById('editVillaLocation').value,
                price: parseFloat(document.getElementById('editVillaPrice').value) || 0,
                guests: parseInt(document.getElementById('editVillaGuests').value) || 0,
                features: document.getElementById('editVillaFeatures').value,
                category: document.getElementById('editVillaCategory').value,
                status: document.getElementById('editVillaStatus').value
            };
            
            // Update villa in data array
            const villaIndex = villasData.findIndex(v => v.id === currentVilla.id);
            if (villaIndex !== -1) {
                villasData[villaIndex] = { ...villasData[villaIndex], ...formData };
                
                // Refresh display
                filteredVillas = applyCurrentFilters();
                displayVillas();
                updateVillaStats();
                
                // Close modal
                const modal = bootstrap.Modal.getInstance(document.getElementById('editVillaModal'));
                modal.hide();
                
                // Show success message
                showToast('Villa modifiée avec succès!', 'success');
                
                console.log('✅ Villa updated:', formData);
            }
        }
        
        function manageCalendar(villaId) {
            // This would open a calendar management interface
            // For now, show a placeholder modal
            showToast('Fonctionnalité calendrier en développement', 'info');
        }
        
        function managePricing(villaId) {
            const villa = villasData.find(v => v.id === villaId);
            if (!villa) return;
            
            currentVilla = villa;
            
            // Populate pricing form
            const pricingRules = villa.pricingRules || {};
            document.getElementById('basePrice').value = pricingRules.base || villa.price || '';
            document.getElementById('weekendPrice').value = pricingRules.weekend || villa.price || '';
            document.getElementById('highSeasonPrice').value = pricingRules.highSeason || villa.price || '';
            
            // Show modal
            const modal = new bootstrap.Modal(document.getElementById('pricingModal'));
            modal.show();
        }
        
        function savePricingChanges() {
            if (!currentVilla) return;
            
            const pricingRules = {
                base: parseFloat(document.getElementById('basePrice').value) || 0,
                weekend: parseFloat(document.getElementById('weekendPrice').value) || 0,
                highSeason: parseFloat(document.getElementById('highSeasonPrice').value) || 0
            };
            
            // Update villa pricing
            const villaIndex = villasData.findIndex(v => v.id === currentVilla.id);
            if (villaIndex !== -1) {
                villasData[villaIndex].pricingRules = pricingRules;
                villasData[villaIndex].price = pricingRules.base; // Update base price
                
                // Refresh display
                filteredVillas = applyCurrentFilters();
                displayVillas();
                
                // Close modal
                const modal = bootstrap.Modal.getInstance(document.getElementById('pricingModal'));
                modal.hide();
                
                showToast('Tarification mise à jour avec succès!', 'success');
                
                console.log('✅ Pricing updated for villa:', currentVilla.name, pricingRules);
            }
        }
        
        // Filtering and search
        function initializeFilters() {
            const searchInput = document.getElementById('villaSearch');
            const categoryFilter = document.getElementById('categoryFilter');
            const statusFilter = document.getElementById('statusFilter');
            const priceFilter = document.getElementById('priceFilter');
            
            if (searchInput) {
                searchInput.addEventListener('input', applyFilters);
            }
            if (categoryFilter) {
                categoryFilter.addEventListener('change', applyFilters);
            }
            if (statusFilter) {
                statusFilter.addEventListener('change', applyFilters);
            }
            if (priceFilter) {
                priceFilter.addEventListener('change', applyFilters);
            }
        }
        
        function applyFilters() {
            filteredVillas = applyCurrentFilters();
            displayVillas();
        }
        
        function applyCurrentFilters() {
            const searchTerm = document.getElementById('villaSearch')?.value.toLowerCase() || '';
            const categoryFilter = document.getElementById('categoryFilter')?.value || '';
            const statusFilter = document.getElementById('statusFilter')?.value || '';
            const priceFilter = document.getElementById('priceFilter')?.value || '';
            
            return villasData.filter(villa => {
                // Search filter
                const matchesSearch = !searchTerm || 
                    villa.name.toLowerCase().includes(searchTerm) ||
                    villa.location.toLowerCase().includes(searchTerm);
                
                // Category filter
                const matchesCategory = !categoryFilter || villa.category === categoryFilter;
                
                // Status filter
                const matchesStatus = !statusFilter || villa.status === statusFilter;
                
                // Price filter
                let matchesPrice = true;
                if (priceFilter) {
                    const [min, max] = priceFilter.split('-').map(p => parseInt(p));
                    if (max) {
                        matchesPrice = villa.price >= min && villa.price <= max;
                    } else {
                        matchesPrice = villa.price >= min;
                    }
                }
                
                return matchesSearch && matchesCategory && matchesStatus && matchesPrice;
            });
        }
        
        // Utility functions
        function showToast(message, type = 'success') {
            const toastContainer = document.getElementById('toastContainer');
            if (!toastContainer) return;
            
            const toastId = 'toast_' + Date.now();
            const toastHtml = `
                <div class="toast" id="${toastId}" role="alert" aria-live="assertive" aria-atomic="true">
                    <div class="toast-header bg-${type} text-white">
                        <i class="fas fa-${type === 'success' ? 'check-circle' : 'info-circle'} me-2"></i>
                        <strong class="me-auto">${type === 'success' ? 'Succès' : 'Information'}</strong>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast"></button>
                    </div>
                    <div class="toast-body">
                        ${message}
                    </div>
                </div>
            `;
            
            toastContainer.insertAdjacentHTML('beforeend', toastHtml);
            const toastElement = document.getElementById(toastId);
            const toast = new bootstrap.Toast(toastElement);
            toast.show();
            
            // Remove toast element after it's hidden
            toastElement.addEventListener('hidden.bs.toast', () => {
                toastElement.remove();
            });
        }
        
        // Initialize when document is ready
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🏖️ Villa Management System initializing...');
            fetchVillasData();
        });
    </script>
</body>
</html>